manual_dictionary = {'1 GENERAL': ['I. GENERAL', 'B-64164EN/01 GENERAL 1.GENERAL - 3 - 1 GENERAL This manual describes the FL-net functions of the FANUC Series 30i/300 i, 31 i/310 i, 32 i/320 i -A. This chapter explains the organi zation of this manual and applied models.'], '1.1 ORGANIZATION OF THIS MANUAL': ['B-64164EN/01 GENERAL 1.GENERAL - 3 - 1 GENERAL This manual describes the FL-net functions of the FANUC Series 30i/300 i, 31 i/310 i, 32 i/320 i -A. This chapter explains the organi zation of this manual and applied models.', '1.GENERAL GENERAL B-64164EN/01 - 4 - 1.1 ORGANIZATION OF THIS MANUAL This manual consists of the following parts: SAFETY PRECAUTIONS Describes the precautions which must be observed when any of the functions explained in this manual is used. I. GENERAL Explains the organization of this manual, lists applicable models, and provides an overview of the FL-net function. II. SPECIFICATION Describes the specifications of the FL-net function. III. SETTING Describes the settings for FL-net communication and notes on creating a ladder program. IV. CONNECTION Describes how to connect devices to enable FL-net communication, as well as related precautions. V. MAINTENANCE Describes FL-net board drawing numbers and the meanings of LED indications', 'B-64164EN/01 GENERAL 1.GENERAL - 5 - 1.2 APPLICABLE MODELS The models covered in this manua l are as follows. The abbreviations listed below may be used to refer to the corresponding models. Model name Abbreviation FANUC Series 30 i-A Series 30 i-A 30 i-A FANUC Series 300 i-A Series 300 i-A 300 i-A 30 i-A FANUC Series 31 i-A FANUC Series 31 i-A5 Series 31 i-A 31 i-A FANUC Series 310 i-A FANUC Series 310 i-A5 Series 310 i-A 310 i-A 31 i-A FANUC Series 32 i-A Series 32 i-A 32 i-A FANUC Series 320 i-A Series 320 i-A 320 i-A 32 i-A 1.3 RELATED MANUALS The related manuals are shown below. See also the following manuals together with this manual. Related manuals of FANUC Series 30 i/300 i, 31 i/310 i, 32 i/320 i -A Manual name Specification number DESCRIPTIONS B-63942EN CONNECTION MANUAL (HARDWARE) B-63943EN CONNECTION MANUAL (FUNCTION) B-63943EN-1 USER’S MANUAL (Common to Lathe System/Machining Center System) B-63944EN USER’S MANUAL (For Lathe System) B-63944EN-1 USER’S MANUAL (For Machining Center System) B-63944EN-2 MAINTENANCE MANUAL B-63945EN PARAMETER MANUAL B-63950EN'], '1.2 APPLICABLE MODELS': ['B-64164EN/01 GENERAL 1.GENERAL - 5 - 1.2 APPLICABLE MODELS The models covered in this manua l are as follows. The abbreviations listed below may be used to refer to the corresponding models. Model name Abbreviation FANUC Series 30 i-A Series 30 i-A 30 i-A FANUC Series 300 i-A Series 300 i-A 300 i-A 30 i-A FANUC Series 31 i-A FANUC Series 31 i-A5 Series 31 i-A 31 i-A FANUC Series 310 i-A FANUC Series 310 i-A5 Series 310 i-A 310 i-A 31 i-A FANUC Series 32 i-A Series 32 i-A 32 i-A FANUC Series 320 i-A Series 320 i-A 320 i-A 32 i-A 1.3 RELATED MANUALS The related manuals are shown below. See also the following manuals together with this manual. Related manuals of FANUC Series 30 i/300 i, 31 i/310 i, 32 i/320 i -A Manual name Specification number DESCRIPTIONS B-63942EN CONNECTION MANUAL (HARDWARE) B-63943EN CONNECTION MANUAL (FUNCTION) B-63943EN-1 USER’S MANUAL (Common to Lathe System/Machining Center System) B-63944EN USER’S MANUAL (For Lathe System) B-63944EN-1 USER’S MANUAL (For Machining Center System) B-63944EN-2 MAINTENANCE MANUAL B-63945EN PARAMETER MANUAL B-63950EN', '2.OVERVIEW OF FL-net FUNCTIONS GENERAL B-64164EN/01 - 6 - 2 OVERVIEW OF FL-net FUNCTIONS This chapter describes the specifications of FL-net functions.'], '1.3 RELATED MANUALS': ['B-64164EN/01 GENERAL 1.GENERAL - 5 - 1.2 APPLICABLE MODELS The models covered in this manua l are as follows. The abbreviations listed below may be used to refer to the corresponding models. Model name Abbreviation FANUC Series 30 i-A Series 30 i-A 30 i-A FANUC Series 300 i-A Series 300 i-A 300 i-A 30 i-A FANUC Series 31 i-A FANUC Series 31 i-A5 Series 31 i-A 31 i-A FANUC Series 310 i-A FANUC Series 310 i-A5 Series 310 i-A 310 i-A 31 i-A FANUC Series 32 i-A Series 32 i-A 32 i-A FANUC Series 320 i-A Series 320 i-A 320 i-A 32 i-A 1.3 RELATED MANUALS The related manuals are shown below. See also the following manuals together with this manual. Related manuals of FANUC Series 30 i/300 i, 31 i/310 i, 32 i/320 i -A Manual name Specification number DESCRIPTIONS B-63942EN CONNECTION MANUAL (HARDWARE) B-63943EN CONNECTION MANUAL (FUNCTION) B-63943EN-1 USER’S MANUAL (Common to Lathe System/Machining Center System) B-63944EN USER’S MANUAL (For Lathe System) B-63944EN-1 USER’S MANUAL (For Machining Center System) B-63944EN-2 MAINTENANCE MANUAL B-63945EN PARAMETER MANUAL B-63950EN', '2.OVERVIEW OF FL-net FUNCTIONS GENERAL B-64164EN/01 - 6 - 2 OVERVIEW OF FL-net FUNCTIONS This chapter describes the specifications of FL-net functions.'], '2 OVERVIEW OF FL-net FUNCTIONS': ['2.OVERVIEW OF FL-net FUNCTIONS GENERAL B-64164EN/01 - 6 - 2 OVERVIEW OF FL-net FUNCTIONS This chapter describes the specifications of FL-net functions.', 'B-64164EN/01 GENERAL 2.OVERVIEW OF FL-net FUNCTIONS - 7 - 2.1 WHAT IS THE FL-net The FL-net is a control-level, open FA network standardized by the FA Open Systems Promotion Forum (FAOP) in the Manufacturing Science and Technology Center, whic h is an outside organization of the Ministry of Economy, Trade and Industry. The FL-net can interconnect various types of FA controllers such as programmable controllers (PLCs) a nd computer numerical controllers (CNCs), and personal computers that are manufactured by many different manufacturers to control and monitor them. Features of the FL-net The FL-net has the following features: Multi-vendor environment using an open network The FL-net conforms not to the FANUC-specific communication standard, but to the open FA network standard so that communication devices manufactured by different vendors (manufacturers) can communicate with each other. Sensor actuatorComputers ControllersUpper LAN Ethernet (TCP/IP, UDP) FL-net (Ethernet-based control network) Company A PLC Company B PLC Company C PLCCompany D personal computerCNC Company E RC DevicesField network Large-scale network Up to 249 communication devices (nodes) can be connected to share data among them. 1 2 248 249 250 254 Node numbers 1 to 249 can be used .Node numbers 250 to 254 (for maintenance)FL-net'], '2.1 WHAT IS THE FL-net': ['B-64164EN/01 GENERAL 2.OVERVIEW OF FL-net FUNCTIONS - 7 - 2.1 WHAT IS THE FL-net The FL-net is a control-level, open FA network standardized by the FA Open Systems Promotion Forum (FAOP) in the Manufacturing Science and Technology Center, whic h is an outside organization of the Ministry of Economy, Trade and Industry. The FL-net can interconnect various types of FA controllers such as programmable controllers (PLCs) a nd computer numerical controllers (CNCs), and personal computers that are manufactured by many different manufacturers to control and monitor them. Features of the FL-net The FL-net has the following features: Multi-vendor environment using an open network The FL-net conforms not to the FANUC-specific communication standard, but to the open FA network standard so that communication devices manufactured by different vendors (manufacturers) can communicate with each other. Sensor actuatorComputers ControllersUpper LAN Ethernet (TCP/IP, UDP) FL-net (Ethernet-based control network) Company A PLC Company B PLC Company C PLCCompany D personal computerCNC Company E RC DevicesField network Large-scale network Up to 249 communication devices (nodes) can be connected to share data among them. 1 2 248 249 250 254 Node numbers 1 to 249 can be used .Node numbers 250 to 254 (for maintenance)FL-net', '2.OVERVIEW OF FL-net FUNCTIONS GENERAL B-64164EN/01 - 8 - Two communication functions available according to the application The FL-net supports both the common memory function and message communication function. The common memory function uses cyclic data transmission to allow the nodes to always share the same data. The message communication function allows the nodes to exchange only required information as required. Large-capacity common memory As common memory, 8K bits + 8K words (a total of 17K bytes) of large-capacity common memory can be shared among all nodes. Node=01 common memory Node=02 Node=03 Node=04 (Transmission) (Reception) (Reception) (Reception) (Transmission) (Reception) (Reception) ・ ・ ・ ・ ・ ・ ・ ・ (Reception) (Reception) (Reception) (Transmission) ・ ・ ・ ・ ・ ・ ・ ・ (Reception) (Reception) (Transmission) (Reception) (Reception) Fast response The FL-net provides a fast response of 50 ms/32 nodes (at 2K bits + 2K words/32 nodes). NOTE This value indicates the speed at which a token is passed through nodes. It does not indicate the time from when data is set in a node to when it seems to be data in a different node. Cyclic transmission + message transmission Cyclic transmission Message data Cyclic data with a token'], '2.2 FANUC FL-net FUNCTIONS': ['2.OVERVIEW OF FL-net FUNCTIONS GENERAL B-64164EN/01 - 8 - Two communication functions available according to the application The FL-net supports both the common memory function and message communication function. The common memory function uses cyclic data transmission to allow the nodes to always share the same data. The message communication function allows the nodes to exchange only required information as required. Large-capacity common memory As common memory, 8K bits + 8K words (a total of 17K bytes) of large-capacity common memory can be shared among all nodes. Node=01 common memory Node=02 Node=03 Node=04 (Transmission) (Reception) (Reception) (Reception) (Transmission) (Reception) (Reception) ・ ・ ・ ・ ・ ・ ・ ・ (Reception) (Reception) (Reception) (Transmission) ・ ・ ・ ・ ・ ・ ・ ・ (Reception) (Reception) (Transmission) (Reception) (Reception) Fast response The FL-net provides a fast response of 50 ms/32 nodes (at 2K bits + 2K words/32 nodes). NOTE This value indicates the speed at which a token is passed through nodes. It does not indicate the time from when data is set in a node to when it seems to be data in a different node. Cyclic transmission + message transmission Cyclic transmission Message data Cyclic data with a token', "B-64164EN/01 GENERAL 2.OVERVIEW OF FL-net FUNCTIONS - 9 - High reliability Each node can participate in or be disconnected from the FL-net at any time. So, the power to each node can be turned on or off without restraint to provide high maintainability. The masterless token method allows communication to be continued without stopping the network by the token management if a failure occurs in a communication device. Node #1Token A time-out occurs. Node #2 Node #3 Node #1 Node #2 Node #3Token Node #1Token Node #2 Node #3A token is reissued. Node #4 Low cost The use of cables for Ethernet, wh ich is now widespread in the OA field, can reduce the cost of communication devices such as transceivers and hubs. High maintainability Various types of management tables are available. The management tables can be referenced to identify a faulty node quickly. NOTE For information about the FL-net, see the following home page of the Japan Electrical Manufacturers' Association: http://www.jema-net.or.jp/", '2.OVERVIEW OF FL-net FUNCTIONS GENERAL B-64164EN/01 - 10 - 2.2 FANUC FL-net FUNCTIONS Cyclic data transmission With the FANUC FL-net, part of large-capacity common memory can be allocated in the PMC E area, R area, or D area to allow the user program to read and write data in the FL-net common memory. The FL-net common memory contains two areas: an 8K-bit (= 0.5K-word) area called area 1 and an 8K-word area called area 2. Generally, common memory area 1 is used for treating bit data and common memory area 2 is used for treating numeric data. For how the PMC memory area corresponds to each common memory area and how to allocate common memory areas, see Sections 2.1, "Common Memory Area 1 Cyclic Transmission," and 2.2, "Common Memory Area 2 Cyclic Transmission," in "II. Specification." Message data transmission The message data transmission function is the other FL-net function. With this function, the user pr ogram also executes message data transmission services via PMC memory areas. To perform message data transmission, the user program writes the transmission request code of message data transmission in the PMC memory area that has been set as an message data transmission interface in advance. The user program also reads received message data via a PMC memory area. Part of message data transmission server (request receiver) processing may be performed in the FL-net board without user-program intervention. FL-net Common memory area 1 PMC memory PMC memory Cyclic data transmission User programUser program FL-net boardCommon memory area 2 Common memory area 1 Common memory area 2 FL-net board', 'B-64164EN/01 GENERAL 2.OVERVIEW OF FL-net FUNCTIONS - 11 - For details of message data tran smission, see Chapter 3, "Message Transmission," in "II. Specification." NOTE The FL-net communication standards have two versions: version 1.00 and version 2.00. These versions cannot be used together. The FANUC FL-net complies with the FL-net communication standards version 2.00. So, when FL-net devices manufactured by FANUC are used, the entire network system must comply with the FL-net communication standards version 2.00. FL-net PMC memory PMC memory Cyclic data transmission User programUser program FL-net board FL-net board', '', 'II. SPECIFICATION', '', 'B-64164EN/01 SPECIFICATION 1.PARAMETERS FOR FL-net FUNCTION - 15 - 1 PARAMETERS FOR FL-net FUNCTION The parameters for the FL-net function are divided into six major groups: (1) Basic parameters (2) State monitoring parameters (3) Area 1 allocation parameters (4) Area 2 allocation parameters (5) Message allocation parameters (6) Bit parameters Each parameter is detailed below. (1) Basic parameters These parameters are defined by the FL-net communication standards and must be set for every FL-net device of any manufacturer. Table 1-1 Basic Parameters Parameter name Description Parameter number IP address IP address of the local node (The host address section (the last numeric value) of this IP address is the node number of the local node.) Pa10 Address of area 1 Start address of a common memory area 1 area allocated as DO of the local node Pa11 Area 1 size Data size of a common memory area 1 area allocated as DO of the local node Pa12 Address of area 2 Start address of a common memory area 2 area allocated as DO of the local node Pa13 Area 2 size Data size of a common memory area 2 area allocated as DO of the local node Pa14 Token monitoring time Token hold time of the local node Pa15 Allowable minimum frame interval Inter-frame time interval requested to another node Pa16 Node name Equipment name of the local node Pa17'], 'II. SPECIFICATION': ['B-64164EN/01 SPECIFICATION 1.PARAMETERS FOR FL-net FUNCTION - 15 - 1 PARAMETERS FOR FL-net FUNCTION The parameters for the FL-net function are divided into six major groups: (1) Basic parameters (2) State monitoring parameters (3) Area 1 allocation parameters (4) Area 2 allocation parameters (5) Message allocation parameters (6) Bit parameters Each parameter is detailed below. (1) Basic parameters These parameters are defined by the FL-net communication standards and must be set for every FL-net device of any manufacturer. Table 1-1 Basic Parameters Parameter name Description Parameter number IP address IP address of the local node (The host address section (the last numeric value) of this IP address is the node number of the local node.) Pa10 Address of area 1 Start address of a common memory area 1 area allocated as DO of the local node Pa11 Area 1 size Data size of a common memory area 1 area allocated as DO of the local node Pa12 Address of area 2 Start address of a common memory area 2 area allocated as DO of the local node Pa13 Area 2 size Data size of a common memory area 2 area allocated as DO of the local node Pa14 Token monitoring time Token hold time of the local node Pa15 Allowable minimum frame interval Inter-frame time interval requested to another node Pa16 Node name Equipment name of the local node Pa17', '1.PARAMETERS FOR FL-net FUNCTION SPECIFICATION B-64164EN/01 - 16 - (2) State monitoring parameters These parameters are used to assign local node status data and remote node status data to the PMC area so that the user program can monitor the statuses of the local node and remote nodes. Table 1-2 State Monitoring Parameters Parameter name Description Parameter number Local node status Start addr ess of an area in the PMC E/R area used as the output destinati on of status information about the local node Pa20 List of participating nodes Start address of an area in the PMC E/R area used as the output destination of a list of all nodes participating in the network Pa21 (3) Area 1 allocation parameters These parameters are used to specify addresses to perform data exchange between common memory area 1 and the PMC area. Table 1-3 Area 1 Allocation Parameters Parameter name Description Parameter number PMC start address (shared by DI/DO) Start address of an area in the PMC E/R area allocated to common memory area 1 Pa30 Area 1 start address(shared by DI/DO) Start address of common memory area 1 allocated to an area in the PMC E/R area Pa31 Allocation size (shared by DI/DO) Size of data to be exchanged Pa32 (4) Area 2 allocation parameters These parameters are used to specify addresses to perform data exchange between common memory area 2 and the PMC area. Since common memory area 2 is larger than the PMC area, allocating separate DI and DO areas is permitted as well as allocating DI and DO at a time in the same way as for common memory area 1. Table 1-4 Area 2 Allocation Parameters (Shared by DI and DO) Parameter name Description Parameter number PMC start address (shared by DI/DO) Start address of an area in the PMC E/R/D area allocated to common memory area 2 Pa47 Area 2 start address(shared by DI/DO) Start address of common memory area 2 allocated to an area in the PMC E/R/D area Pa48 Allocation size (shared by DI/DO) Size of data to be exchanged Pa49'], '1 PARAMETERS FOR FL-net FUNCTION': ['B-64164EN/01 SPECIFICATION 1.PARAMETERS FOR FL-net FUNCTION - 15 - 1 PARAMETERS FOR FL-net FUNCTION The parameters for the FL-net function are divided into six major groups: (1) Basic parameters (2) State monitoring parameters (3) Area 1 allocation parameters (4) Area 2 allocation parameters (5) Message allocation parameters (6) Bit parameters Each parameter is detailed below. (1) Basic parameters These parameters are defined by the FL-net communication standards and must be set for every FL-net device of any manufacturer. Table 1-1 Basic Parameters Parameter name Description Parameter number IP address IP address of the local node (The host address section (the last numeric value) of this IP address is the node number of the local node.) Pa10 Address of area 1 Start address of a common memory area 1 area allocated as DO of the local node Pa11 Area 1 size Data size of a common memory area 1 area allocated as DO of the local node Pa12 Address of area 2 Start address of a common memory area 2 area allocated as DO of the local node Pa13 Area 2 size Data size of a common memory area 2 area allocated as DO of the local node Pa14 Token monitoring time Token hold time of the local node Pa15 Allowable minimum frame interval Inter-frame time interval requested to another node Pa16 Node name Equipment name of the local node Pa17', '1.PARAMETERS FOR FL-net FUNCTION SPECIFICATION B-64164EN/01 - 16 - (2) State monitoring parameters These parameters are used to assign local node status data and remote node status data to the PMC area so that the user program can monitor the statuses of the local node and remote nodes. Table 1-2 State Monitoring Parameters Parameter name Description Parameter number Local node status Start addr ess of an area in the PMC E/R area used as the output destinati on of status information about the local node Pa20 List of participating nodes Start address of an area in the PMC E/R area used as the output destination of a list of all nodes participating in the network Pa21 (3) Area 1 allocation parameters These parameters are used to specify addresses to perform data exchange between common memory area 1 and the PMC area. Table 1-3 Area 1 Allocation Parameters Parameter name Description Parameter number PMC start address (shared by DI/DO) Start address of an area in the PMC E/R area allocated to common memory area 1 Pa30 Area 1 start address(shared by DI/DO) Start address of common memory area 1 allocated to an area in the PMC E/R area Pa31 Allocation size (shared by DI/DO) Size of data to be exchanged Pa32 (4) Area 2 allocation parameters These parameters are used to specify addresses to perform data exchange between common memory area 2 and the PMC area. Since common memory area 2 is larger than the PMC area, allocating separate DI and DO areas is permitted as well as allocating DI and DO at a time in the same way as for common memory area 1. Table 1-4 Area 2 Allocation Parameters (Shared by DI and DO) Parameter name Description Parameter number PMC start address (shared by DI/DO) Start address of an area in the PMC E/R/D area allocated to common memory area 2 Pa47 Area 2 start address(shared by DI/DO) Start address of common memory area 2 allocated to an area in the PMC E/R/D area Pa48 Allocation size (shared by DI/DO) Size of data to be exchanged Pa49', 'B-64164EN/01 SPECIFICATION 1.PARAMETERS FOR FL-net FUNCTION - 17 - Table 1-5 Area 2 Allocation Parameters (Separate Allocation for Each of DI and DO) Parameter name Description Parameter number PMC start address (for DO) Start address of a common memory area in the PMC E area, R area, or D area that serves as the source of data to be written to area 2 Pa40 Allocation size (for DO) Size of data written to common memory area 2 Pa41 PMC start address (for DI) Start address of a common memory area in the PMC R area or D area that serves as the read destination of information about other nodes and data from area 2 Pa42 Allocation condition setting (for DI/DO) Address of a common memory area in the PMC D area that is used to specify conditions on data exchange with area 2 Pa43 Condition switch flag(for DI/DO) Flag for switching between specified conditions at the area 2 data exchange condition allocation address above Pa44 Area 2 start address(for DI) Start address of static common memory area 2 to be allocated in the PMC area Pa45 Allocation size (for DI) Size of data statically exchanged Pa46 (5) Message allocation parameters These parameters are used to specify interface areas for making service requests for message transmission and passing a received message to the user program. Table 1-6 Message Allocation Parameters Parameter name Description Parameter number Client function interface Start address of the PMC E, R, or D area that serves as the interface used by the message transmission client function Pa50 Interface size Maximum allowable size of the interface area used above Pa51 Server function interface Start address of the PMC E, R, or D area that serves as the interface used by the message transmission server function Pa52 Interface size Maximum allowable size of the interface area used above Pa53', '1.PARAMETERS FOR FL-net FUNCTION SPECIFICATION B-64164EN/01 - 18 - (6) Bit parameters Table 1-7 Bit parameters Parameter name Description Parameter number Parameter 1 Parameter for FL-net data transfer Pa60 Parameter 2 Parameter for FL-net operation Pa61 For each FL-net function used, the parameters below need to be set. A. Cyclic transmission of common memory area 1 Basic parameters Area 1 allocation parameters B. Cyclic transmission of common memory area 2 Basic parameters Area 2 allocation parameters C. Message transmission Basic parameters Message allocation parameters For B (Cyclic transmission of common memory area 2) and C (message transmission) above, operation based on a user program needs to be performed as required. For information about required operation, see Section 2.2 “COMMON MEMORY AREA 2 CYCLIC TRANSMISSION”and Chapter 3 “MESSAGE TRANSMISSION”, respectively. When the state monitoring parameters are set, the user program can monitor the state of the local node and the network participation state of other nodes. Perform node state monitoring as required.', 'B-64164EN/01 SPECIFICATION 2.CYCLIC TRANSMISSION - 19 - 2 CYCLIC TRANSMISSION This chapter details how to use th e cyclic data transmission function of the FL-net function.'], '2 CYCLIC TRANSMISSION': ['B-64164EN/01 SPECIFICATION 2.CYCLIC TRANSMISSION - 19 - 2 CYCLIC TRANSMISSION This chapter details how to use th e cyclic data transmission function of the FL-net function.', '2.CYCLIC TRANSMISSION SPECIFICATION B-64164EN/01 - 20 - 2.1 COMMON MEMORY AREA 1 CYCLIC TRANSMISSION Those areas of common memory area 1 that are to be used for data exchange can be allocated in the PM C E area or R are in direct image. Related parameters (1) Pa11: Area 1 address (2) Pa12: Area 1 size (in words) (3) Pa30: PMC start address (4) Pa31: Area 1 start address (5) Pa32: Allocation size (in words) PMC area and common memory area 1 If an allocated area includes a mixture of DI and DO areas as shown below, data exchange is performed by making a distinction between a DI area and a DO area. PMC area Common memory area 1 7 0 15 0 Transmit data from other nodes DI Transmit data from other nodes DO Transmit data of the local node Transmit data from other nodes DI Transmit data from other nodes Transmit data from other nodes NOTE When 0 is set in Pa32 (allocation size ), the data of common memory area 1 is not exchanged. Pa30→ Pa32 Pa12Pa31→ Pa11→'], '2.1 COMMON MEMORY AREA 1 CYCLIC TRANSMISSION': ['2.CYCLIC TRANSMISSION SPECIFICATION B-64164EN/01 - 20 - 2.1 COMMON MEMORY AREA 1 CYCLIC TRANSMISSION Those areas of common memory area 1 that are to be used for data exchange can be allocated in the PM C E area or R are in direct image. Related parameters (1) Pa11: Area 1 address (2) Pa12: Area 1 size (in words) (3) Pa30: PMC start address (4) Pa31: Area 1 start address (5) Pa32: Allocation size (in words) PMC area and common memory area 1 If an allocated area includes a mixture of DI and DO areas as shown below, data exchange is performed by making a distinction between a DI area and a DO area. PMC area Common memory area 1 7 0 15 0 Transmit data from other nodes DI Transmit data from other nodes DO Transmit data of the local node Transmit data from other nodes DI Transmit data from other nodes Transmit data from other nodes NOTE When 0 is set in Pa32 (allocation size ), the data of common memory area 1 is not exchanged. Pa30→ Pa32 Pa12Pa31→ Pa11→', 'B-64164EN/01 SPECIFICATION 2.CYCLIC TRANSMISSION - 21 - 2.2 COMMON MEMORY AREA 2 CYCLIC TRANSMISSION Data exchange with common memory area 2 is performed using one of the following two methods: (1) Simultaneous allocation of DI and DO areas Like the method for data exchange with common memory area 1, common memory areas are directly allocated to the PMC area just as they are allocated in common memory. (2) Separate allocation of DI and DO areas DI and DO areas are separately allocated for data exchange between common memory area 2 and the PMC area. When this method is used, there are two DI area allocation methods: (1) A method that allows DI data areas to be changed dynamically on a node-by-node basis, and (2) a method that statically uses fixed DI data areas independent of nodes. NOTE 1 When a small amount of data is exchanged, allocation method (1) should be used because method (1) is simpler than method (2). 2 Setting bit 2 of Pa61 (parameter 2) switches between the above two allocation methods. For details, see Section 1.1, "PARAMETERS FOR FL-net FUNCTION" in "III. SETTING".'], '2.2 COMMON MEMORY AREA 2 CYCLIC TRANSMISSION': ['B-64164EN/01 SPECIFICATION 2.CYCLIC TRANSMISSION - 21 - 2.2 COMMON MEMORY AREA 2 CYCLIC TRANSMISSION Data exchange with common memory area 2 is performed using one of the following two methods: (1) Simultaneous allocation of DI and DO areas Like the method for data exchange with common memory area 1, common memory areas are directly allocated to the PMC area just as they are allocated in common memory. (2) Separate allocation of DI and DO areas DI and DO areas are separately allocated for data exchange between common memory area 2 and the PMC area. When this method is used, there are two DI area allocation methods: (1) A method that allows DI data areas to be changed dynamically on a node-by-node basis, and (2) a method that statically uses fixed DI data areas independent of nodes. NOTE 1 When a small amount of data is exchanged, allocation method (1) should be used because method (1) is simpler than method (2). 2 Setting bit 2 of Pa61 (parameter 2) switches between the above two allocation methods. For details, see Section 1.1, "PARAMETERS FOR FL-net FUNCTION" in "III. SETTING".', '2.CYCLIC TRANSMISSION SPECIFICATION B-64164EN/01 - 22 - 2.2.1 Simultaneous DI and DO Area Allocation Areas of common memory area 2 that are to be used for data exchange can be allocated to the E, R, or D area of the PMC just as they are allocated in common memory. Related parameters (1) Pa13: Area 2 address (2) Pa14: Area 2 size (in words) (3) Pa47: PMC start address (4) Pa48: Area 2 start address (5) Pa49: Allocation size (in words) (6) Pa61: Bit 2 (DTL) of parameter 2 = 0 PMC area and common memory area 2 Even when an allocated area contains both DI and DO areas as follows, data exchange is performed with the DI and DO areas distinguished from each other. PMC area Common memory area 2 7 0 1 5 0 Transmit data from other nodes DI Transmit data from other nodes Transmit data of DO the local node Transmit data from other nodes DI Transmit data from other nodes Transmit data from other nodes NOTE When 0 is set in Pa49 (allocation size), data exchange with common memory area 2 is not performed. Pa47→ Pa49 Pa14Pa48→ Pa13→'], '2.2.1 Simultaneous DI and DO Area Allocation': ['2.CYCLIC TRANSMISSION SPECIFICATION B-64164EN/01 - 22 - 2.2.1 Simultaneous DI and DO Area Allocation Areas of common memory area 2 that are to be used for data exchange can be allocated to the E, R, or D area of the PMC just as they are allocated in common memory. Related parameters (1) Pa13: Area 2 address (2) Pa14: Area 2 size (in words) (3) Pa47: PMC start address (4) Pa48: Area 2 start address (5) Pa49: Allocation size (in words) (6) Pa61: Bit 2 (DTL) of parameter 2 = 0 PMC area and common memory area 2 Even when an allocated area contains both DI and DO areas as follows, data exchange is performed with the DI and DO areas distinguished from each other. PMC area Common memory area 2 7 0 1 5 0 Transmit data from other nodes DI Transmit data from other nodes Transmit data of DO the local node Transmit data from other nodes DI Transmit data from other nodes Transmit data from other nodes NOTE When 0 is set in Pa49 (allocation size), data exchange with common memory area 2 is not performed. Pa47→ Pa49 Pa14Pa48→ Pa13→', 'B-64164EN/01 SPECIFICATION 2.CYCLIC TRANSMISSION - 23 - 2.2.2 Separate Allocation of DI and DO Areas For data exchange with common memory area 2, DI and DO areas can be set separately to allocate them to the E, R, or D area of the PMC. NOTE When a small amount of data in common memory area 2 is to be exchanged, make settings for data exchange between common memory area 2 and the PMC area according to the method described in Subsection 2.2.1, "Simultaneous DI and DO Area Allocation". 2.2.2.1 DO data allocation In data exchange of DO data in common memory area 2, data can be shifted by an offset when the data is transferred from the PMC area to common memory area in case the PMC area that can be allocated is smaller than the common memory area of the local node. General DO data allocation Related parameters (1) Pa13: Area 2 address (2) Pa14: Area 2 size (in words) (3) Pa40: PMC start address (for DO) (4) Pa41: Allocation size (for DO) (in words) (5) Pa61: Bit 2 (DTL) of parameter 2 = 1 PMC area and common memory area 2 PMC R area Common memory area 2 7 0 1 5 0 Transmit data from other nodes DO Transmit data of the local node Transmit data from other nodes NOTE When 0 is set in Pa41 (allocation size (for DO)), DO data exchange from the PMC area to common memory area 2 is not performed. Pa40→ Pa41 Pa14Pa13→'], '2.2.2 Separate Allocation of DI and DO Areas': ['B-64164EN/01 SPECIFICATION 2.CYCLIC TRANSMISSION - 23 - 2.2.2 Separate Allocation of DI and DO Areas For data exchange with common memory area 2, DI and DO areas can be set separately to allocate them to the E, R, or D area of the PMC. NOTE When a small amount of data in common memory area 2 is to be exchanged, make settings for data exchange between common memory area 2 and the PMC area according to the method described in Subsection 2.2.1, "Simultaneous DI and DO Area Allocation". 2.2.2.1 DO data allocation In data exchange of DO data in common memory area 2, data can be shifted by an offset when the data is transferred from the PMC area to common memory area in case the PMC area that can be allocated is smaller than the common memory area of the local node. General DO data allocation Related parameters (1) Pa13: Area 2 address (2) Pa14: Area 2 size (in words) (3) Pa40: PMC start address (for DO) (4) Pa41: Allocation size (for DO) (in words) (5) Pa61: Bit 2 (DTL) of parameter 2 = 1 PMC area and common memory area 2 PMC R area Common memory area 2 7 0 1 5 0 Transmit data from other nodes DO Transmit data of the local node Transmit data from other nodes NOTE When 0 is set in Pa41 (allocation size (for DO)), DO data exchange from the PMC area to common memory area 2 is not performed. Pa40→ Pa41 Pa14Pa13→', '2.CYCLIC TRANSMISSION SPECIFICATION B-64164EN/01 - 24 - Allocation when common memory area 2 of the local node is too large When common memory area 2 of the local node is too large to prepare DO data of the local node in the PMC area at one time, an offset can be specified by a user program (such as a ladder program) at the time of DO data transfer from the PMC area to common memory area 2. Related parameters (1) Pa13: Area 2 address (2) Pa14: Area 2 size (in words) (3) Pa40: PMC start address (for DO) (4) Pa41: Allocation size (for DO) (in words) (5) Pa43: Allocation condition setting (for DI/DO) (6) Pa44: Condition switch flag (for DI/DO) (7) Pa61: Bit 2 (DTL) of parameter 2 = 1 Allocation condition setting organization Organization of area 2 data ex change condition allocation: When PMC data is transferred to common memory by shifting the data by an offset, the following must be set: 7 0 Dxxxx+0 Node number Dxxxx+2 DI offset (in words) Dxxxx+4 Data size (in words) Dxxxx+6 DO offset (in words) NOTE The parts except the shaded part are not used by this function. Procedure Procedure for changing the offset of DO data in common memory area 2 by using the user program: (1) The user program specifies the following in the PMC D area specified by Pa43 (allocation condition setting (for DI/DO)): - DO offset (2) At a later time, the user program writes FFh in the PMC E or R area specified by Pa44 (condition switch flag (for DI/DO)) (called the switch flag hereinafter). (3) The CNC monitors the switch fl ag at all times. When FFh is written, the CNC reads the DO o ffset set in the PMC D area as internal information, and sets the switch flag to 00h (Note 1). (4) Unless FFh is written in the switch flag, the CNC uses the same DO offset value to write DO data placed in the PMC area allocated by Pa40 (allocation address (for DO)) into common memory area 2. Pa43→'], '2.2.2.1 DO data allocation': ['B-64164EN/01 SPECIFICATION 2.CYCLIC TRANSMISSION - 23 - 2.2.2 Separate Allocation of DI and DO Areas For data exchange with common memory area 2, DI and DO areas can be set separately to allocate them to the E, R, or D area of the PMC. NOTE When a small amount of data in common memory area 2 is to be exchanged, make settings for data exchange between common memory area 2 and the PMC area according to the method described in Subsection 2.2.1, "Simultaneous DI and DO Area Allocation". 2.2.2.1 DO data allocation In data exchange of DO data in common memory area 2, data can be shifted by an offset when the data is transferred from the PMC area to common memory area in case the PMC area that can be allocated is smaller than the common memory area of the local node. General DO data allocation Related parameters (1) Pa13: Area 2 address (2) Pa14: Area 2 size (in words) (3) Pa40: PMC start address (for DO) (4) Pa41: Allocation size (for DO) (in words) (5) Pa61: Bit 2 (DTL) of parameter 2 = 1 PMC area and common memory area 2 PMC R area Common memory area 2 7 0 1 5 0 Transmit data from other nodes DO Transmit data of the local node Transmit data from other nodes NOTE When 0 is set in Pa41 (allocation size (for DO)), DO data exchange from the PMC area to common memory area 2 is not performed. Pa40→ Pa41 Pa14Pa13→', '2.CYCLIC TRANSMISSION SPECIFICATION B-64164EN/01 - 24 - Allocation when common memory area 2 of the local node is too large When common memory area 2 of the local node is too large to prepare DO data of the local node in the PMC area at one time, an offset can be specified by a user program (such as a ladder program) at the time of DO data transfer from the PMC area to common memory area 2. Related parameters (1) Pa13: Area 2 address (2) Pa14: Area 2 size (in words) (3) Pa40: PMC start address (for DO) (4) Pa41: Allocation size (for DO) (in words) (5) Pa43: Allocation condition setting (for DI/DO) (6) Pa44: Condition switch flag (for DI/DO) (7) Pa61: Bit 2 (DTL) of parameter 2 = 1 Allocation condition setting organization Organization of area 2 data ex change condition allocation: When PMC data is transferred to common memory by shifting the data by an offset, the following must be set: 7 0 Dxxxx+0 Node number Dxxxx+2 DI offset (in words) Dxxxx+4 Data size (in words) Dxxxx+6 DO offset (in words) NOTE The parts except the shaded part are not used by this function. Procedure Procedure for changing the offset of DO data in common memory area 2 by using the user program: (1) The user program specifies the following in the PMC D area specified by Pa43 (allocation condition setting (for DI/DO)): - DO offset (2) At a later time, the user program writes FFh in the PMC E or R area specified by Pa44 (condition switch flag (for DI/DO)) (called the switch flag hereinafter). (3) The CNC monitors the switch fl ag at all times. When FFh is written, the CNC reads the DO o ffset set in the PMC D area as internal information, and sets the switch flag to 00h (Note 1). (4) Unless FFh is written in the switch flag, the CNC uses the same DO offset value to write DO data placed in the PMC area allocated by Pa40 (allocation address (for DO)) into common memory area 2. Pa43→', 'B-64164EN/01 SPECIFICATION 2.CYCLIC TRANSMISSION - 25 - PMC area and common memory area 2 PMC D area 7 0 Dxxxx+0 Node number Dxxxx+2 DI offset Dxxxx+4 Data size Dxxxx+6 O offset PMC E/R area Switch flag Common memory area 2 1 5 0 PMC area Transmit data from other nodes Transmit data of DO the local node Transmit data from other nodes NOTE 1 When the offset is dynamically changed for DO data allocation of common memory area 2, the node number, DI offset, and data size are also changed. To change only the DO data offset, carefully change the setting not to change other values. 2 There are the following restrictions on DO data exchange: - When 0 is set in Pa41 (allocation size (for DO)), DO data exchanged from the PMC area to common memory area 2 is not performed. - When the PMC area for Pa43 (allocation condition setting (for DI/DO)) is not set, the DO offset is assumed to be 0. - When the PMC area for Pa44 (condition switch flag (for DI/DO)) is not set, it is impossible to change the DO offset dynamically. - When (DO offset + Pa41) > Pa14, DO data exchange is not performed. Pa43→ Pa44→ Pa40→ Pa41 Pa14Pa13→', '2.CYCLIC TRANSMISSION SPECIFICATION B-64164EN/01 - 26 - 2.2.2.2 DI data allocation Whether to perform dynamic allocation or static allocation of DI data of common memory area 2 can be specified by the setting of Pa46 (allocation size (for DI)). Dynamic DI data allocation of common memory area 2 The user program switches to the DI data area for a target node and reads the DI data for the node. By specifying a node number, the DI data from the node and status information of the node can be read. Related parameters (1) Pa42: PMC start address (for DI) (2) Pa43: Allocation condition setting (for DI/DO) (3) Pa44: Condition switch flag (for DI/DO) (4) Pa46: Allocation size (for DI) = 0 (5) Pa61: Bit 2 (DTL) of parameter 2 = 1 Allocation condition setting organization Organization of area 2 data ex change condition allocation: 7 0 Dxxxx+0 Node number Dxxxx+2 DI offset (in words) Dxxxx+4 Data size (in words) Dxxxx+6 DO offset (in words) NOTE The parts except the shaded part are not used by this function. Procedure Procedure for changing dynamic DI allocation of common memory area 2 by using the user program: (1) The user program specifies the following in the PMC D area specified by Pa43 (allocation condition setting (for DI/DO)): - Node number - DI offset - Data size (2) Then, the user program writes FFh to the area (switch flag) in the PMC E area or the PMC R area specified by Pa44 (condition switch flag (for DI/DO)). Pa43→'], '2.2.2.2 DI data allocation': ['2.CYCLIC TRANSMISSION SPECIFICATION B-64164EN/01 - 26 - 2.2.2.2 DI data allocation Whether to perform dynamic allocation or static allocation of DI data of common memory area 2 can be specified by the setting of Pa46 (allocation size (for DI)). Dynamic DI data allocation of common memory area 2 The user program switches to the DI data area for a target node and reads the DI data for the node. By specifying a node number, the DI data from the node and status information of the node can be read. Related parameters (1) Pa42: PMC start address (for DI) (2) Pa43: Allocation condition setting (for DI/DO) (3) Pa44: Condition switch flag (for DI/DO) (4) Pa46: Allocation size (for DI) = 0 (5) Pa61: Bit 2 (DTL) of parameter 2 = 1 Allocation condition setting organization Organization of area 2 data ex change condition allocation: 7 0 Dxxxx+0 Node number Dxxxx+2 DI offset (in words) Dxxxx+4 Data size (in words) Dxxxx+6 DO offset (in words) NOTE The parts except the shaded part are not used by this function. Procedure Procedure for changing dynamic DI allocation of common memory area 2 by using the user program: (1) The user program specifies the following in the PMC D area specified by Pa43 (allocation condition setting (for DI/DO)): - Node number - DI offset - Data size (2) Then, the user program writes FFh to the area (switch flag) in the PMC E area or the PMC R area specified by Pa44 (condition switch flag (for DI/DO)). Pa43→', 'B-64164EN/01 SPECIFICATION 2.CYCLIC TRANSMISSION - 27 - (3) The CNC monitors the switch fl ag at all times. When FFh is written, the node number, DI offset, and data size set in the PMC D area are taken in as internal information, and the switch flag is set to 00h. At this time, the CNC once reads DI data according to the new settings before the switch flag is set to 00h. So, the user program can read DI data immediately after checking that the switch flag is set to 00h. (4) Until FFh is written to the switch flag, the user program can read the node information of a specified node number and area 2 DI data from the PMC area. (5) Until FFh is written to the switch flag, the CNC writes the node information of a specified node number and area 2 DI data to the specified area in the PMC area. PMC D area 7 0 Dxxxx+0 Node number Dxxxx+2 DI offset Dxxxx+4 Data size Dxxxx+6 DO offset PMC E/R area Switch flag Common memory area 2 1 5 0 PMC area Transmit data from other nodes Transmit data Information on other nodes from other nodes DI data Transmit data from other nodes Transmit data from other nodes NOTE 1 When node information or DI data is dynamically changed for dynamic DI data allocation of common memory area 2, the DO offset is also changed. To change only the DI data, carefully change the setting not to change another value. Pa43→ Pa44→ Pa42→ (Note 2 )', '2.CYCLIC TRANSMISSION SPECIFICATION B-64164EN/01 - 28 - NOTE 2 Information on other nodes is 4 bytes in size. So, for an area in the PMC area to be allocated for DI, allocate an area 4 bytes larger than the value set in Dxxxx+4 (data size (in words). When the user program handles DI data in area 2, the data at the address 4 bytes shifted from the address set in Pa42 (PMC start address (for DI)) is handled. 3 There are the following restrictions on dynamic DI data exchange: - Set a value of 0 in Pa46 (allocation size (for DI)). - When the PMC area for Pa42 (PMC start address (for DI)) is not set, transfer of information on other nodes and DI data exchange are not performed. - When the PMC area for Pa43 (allocation condition setting (for DI/DO)) is not set, transfer of information on other nodes and DI data exchange are not performed. - When 0 is specified in Dxxxx+4 (data size) specified by Pa43 (allocation condition setting (for DI/DO)), transfer of information on other nodes and DI data exchange are not performed. - When the PMC area for Pa44 (condition switch flag (for DI/DO)) is not set, it is impossible to change the DI data source dynamically. 4 When DI data exchange is performed with a size specification with which t he local node transmit data area is contained, data transfer from the common memory area to the PMC area may overwrite the PMC area data with the common memory data. Carefully specify the data size so that the local node transmit data area is not contained. 5 When a node specified for node switching is disconnected, the status of the node is indicated, but the DI data of t he previous node before switching stays unchanged because a common memory area cannot be determined. Therefore, when switching between nodes, first check the status information to ensure that the new node participates in the network, then reference DI data. If the new node is disconnected, DI data will be updated to the DI data of the node as soon as the node participates in the network.', 'B-64164EN/01 SPECIFICATION 2.CYCLIC TRANSMISSION - 29 - Static DI data allocation of common memory area 2 This allocation method fixes the DI data area. With this method, an area larger than that allocated w ith the dynamic allocation method can be allocated in the PMC area. Only node status information can be read by dynamic change. Related parameters (1) Pa42: PMC start address (for DI) (2) Pa43: Allocation condition setting (for DI/DO) (3) Pa44: Condition switch flag (for DI/DO) (4) Pa45: Area 2 start address (for DI) (5) Pa46: Allocation size (for DI) (6) Pa61: Bit 2 (DTL) of parameter 2 = 1 NOTE When node status information is unnecessary, Pa43 and Pa44 need not be set. Furthermore, "Allocation condition setting organization" and "Procedure" given below are unnecessary. Allocation condition setting organization Organization of area 2 data ex change condition allocation: 7 0 Dxxxx+0 Node number Dxxxx+2 DI offset (in words) Dxxxx+4 Data size (in words) Dxxxx+6 DO offset (in words) NOTE The parts except the shaded part are not used by this function. Procedure Procedure of node information change by the user program: (1) The user program specifies the following in the PMC D area specified by Pa43 (allocation condition setting (for DI/DO)): - Node number (2) Then, the user program writes FFh to the area (switch flag) in the PMC E area or the PMC R area specified by Pa44 (condition switch flag (for DI/DO)). Pa43→', '2.CYCLIC TRANSMISSION SPECIFICATION B-64164EN/01 - 30 - (3) The CNC monitors the switch fl ag at all times. When FFh is written, the node number set in the PMC D area are taken in as internal information, and the switch flag is set to 00h. At this time, the CNC once updates the specified node status information according to the new settings before the switch flag is set to 00h. So, the user program can read the status information immediately after checking that the switch flag is set to 00h. (4) Until FFh is written to the switch flag, the user program can read the node information of a specified node number from the PMC area. (5) Until FFh is written to the switch flag, the CNC writes the node information of a specified node number to the specified area in the PMC area. The DI data can be read regardless of whether the switch flag is set to 00h. PMC D area 7 0 Dxxxx+0 Node number Dxxxx+2 DI offset Dxxxx+4 Data size Dxxxx+6 DO offset PMC E/R area Switch flag Common memory area 2 1 5 0 PMC area Transmit data from other nodes Transmit data Information on other nodes from other nodes DI data Transmit data of the local node Transmit data from other nodes Pa43→ Pa44→ Pa42→ (Note 3 )Pa45→ Pa46 Pa40→Pa41', 'B-64164EN/01 SPECIFICATION 2.CYCLIC TRANSMISSION - 31 - NOTE 1 As shown in the above ex ample, the area specified by Pa46 (allocation size (for DI)) can contain the local node transmit data area. In this case, the corresponding PMC area can be specified for Pa40 (PMC start address (for DO)) to allocate no wasted PMC area. To make such a setting, however, carefully set Pa40 (PMC start address (for DO)) not to duplicate PMC area setting. 2 Node information can also be changed dynamically with static DI data allocation of common memory area 2. When node information is changed, however, the DO offset is also changed. To change only the node information, carefully change the setting not to change the DO offset. 3 Information on other nodes is 4 bytes in size. So, for an area in the R area to be allocated for DI, allocate an area 4 bytes larger than the value set in Pa46 (allocation size (for DI)). When the user program handles DI data in area 2, the data at the address 4 bytes shifted from the address set in Pa42 (allocation address (for DI)) is handled. 4 There are the following restri ctions on static DI data exchange: - When a value of 0 is specified for Pa46 (allocation size (for DI)), DI data exchange with dynamic allocation is performed. - When the PMC area for Pa42 (allocation address (for DI)) is not set, transfer of information on other nodes and DI data exchange are not performed. - When the PMC area for Pa43 (allocation condition setting (for DI/DO)) is not set, transfer of information on other nodes is not performed. - When the PMC area for Pa44 (switch flag allocation address) is not set, it is impossible to change node information dynamically.', '2.CYCLIC TRANSMISSION SPECIFICATION B-64164EN/01 - 32 - 2.2.2.3 Nodes information Information on other nodes and DI data are allocated in the PMC area as follows: 7 0 ＋0(Reserved) ＋1FA link layer state ＋2Upper layer state ＋4DI data FA link layer state: 1 byte 7 6 5 4 3 2 1 0 +1 <1> <2> <3> <4> (Reserved) <5> <6> <6> Node participation flag (1: Participate) <5> Communication disable detection flag (1: Detected) <4> Upper layer operation signal error flag (1: Error) <3> Common memory data valid flag (1: Valid) <2> Common memory setting complete flag (1: Complete) <1> Duplicate address detection flag (1: Duplicate address detected) Upper layer state: 2 bytes 7 6 5 4 3 2 1 0 +2 <8> <9> <10> <11> <12> <13> <14> <15> +3 <1> <2> <3> (Reserved) <4> <5> <6> <7> U_ERR_CODE <4> (Highest bit) to <15> (Lowest bit) <2>, <3> U_ERR 00: NORMAL 01: WARNING 1x: ALARM <1> RUN/STOP 0: STOP 1: RUN NOTE For details of each bit, see Subsection 2.3.1, "Allocation of Local Node State." Pa42→'], '2.2.2.3 Nodes information': ['2.CYCLIC TRANSMISSION SPECIFICATION B-64164EN/01 - 32 - 2.2.2.3 Nodes information Information on other nodes and DI data are allocated in the PMC area as follows: 7 0 ＋0(Reserved) ＋1FA link layer state ＋2Upper layer state ＋4DI data FA link layer state: 1 byte 7 6 5 4 3 2 1 0 +1 <1> <2> <3> <4> (Reserved) <5> <6> <6> Node participation flag (1: Participate) <5> Communication disable detection flag (1: Detected) <4> Upper layer operation signal error flag (1: Error) <3> Common memory data valid flag (1: Valid) <2> Common memory setting complete flag (1: Complete) <1> Duplicate address detection flag (1: Duplicate address detected) Upper layer state: 2 bytes 7 6 5 4 3 2 1 0 +2 <8> <9> <10> <11> <12> <13> <14> <15> +3 <1> <2> <3> (Reserved) <4> <5> <6> <7> U_ERR_CODE <4> (Highest bit) to <15> (Lowest bit) <2>, <3> U_ERR 00: NORMAL 01: WARNING 1x: ALARM <1> RUN/STOP 0: STOP 1: RUN NOTE For details of each bit, see Subsection 2.3.1, "Allocation of Local Node State." Pa42→', 'B-64164EN/01 SPECIFICATION 2.CYCLIC TRANSMISSION - 33 - 2.2.2.4 Timing of switching between conditions on data exchange with common memory area 2 In data exchange between common memory area 2 and the PMC area, the user can switch between data (nodes information) exchange conditions. The timing of data switching specified by the user program is described below. User program System (1) Sets each parameter in the PMC D area specified by Pa43. (2) Sets FFh in the switch flag specified by Pa44. (3) Checks that the switch flag is set to FFh. (4) Reads each parameter from the PMC D area specified by Pa43. (5) Exchanges data under a new data exchange condition. (7) Checks that the switch flag is set to 00h. (6) Sets 00h in the switch flag. (8) Performs data processing. Performs data exchange under the new data exchange condition from this point and up. CAUTION 1 If the setting of a param eter in the PMC D area specified by Pa43 (allocation condition setting (for DI/DO)) is incorrect (for example, if a specified DI offset exceeds the common memory area of a specified node number), data exchange is not performed. So, be careful when making a data exchange condition modification. 2 Do not access the DI data of common memory area 2 until the switch flag is set to 00h after the switch flag is set to FFh by the user program. Otherwise, invalid data may be read. NOTE Immediately after the power is turned on, data exchange is performed according to each parameter set in the PM C D area specified by Pa43 (allocation condition setting (for DI/DO)) even if no instruction is provided by the user program.'], '2.2.2.4 Timing of switching between conditions on data exchange with common memory area 2': ['B-64164EN/01 SPECIFICATION 2.CYCLIC TRANSMISSION - 33 - 2.2.2.4 Timing of switching between conditions on data exchange with common memory area 2 In data exchange between common memory area 2 and the PMC area, the user can switch between data (nodes information) exchange conditions. The timing of data switching specified by the user program is described below. User program System (1) Sets each parameter in the PMC D area specified by Pa43. (2) Sets FFh in the switch flag specified by Pa44. (3) Checks that the switch flag is set to FFh. (4) Reads each parameter from the PMC D area specified by Pa43. (5) Exchanges data under a new data exchange condition. (7) Checks that the switch flag is set to 00h. (6) Sets 00h in the switch flag. (8) Performs data processing. Performs data exchange under the new data exchange condition from this point and up. CAUTION 1 If the setting of a param eter in the PMC D area specified by Pa43 (allocation condition setting (for DI/DO)) is incorrect (for example, if a specified DI offset exceeds the common memory area of a specified node number), data exchange is not performed. So, be careful when making a data exchange condition modification. 2 Do not access the DI data of common memory area 2 until the switch flag is set to 00h after the switch flag is set to FFh by the user program. Otherwise, invalid data may be read. NOTE Immediately after the power is turned on, data exchange is performed according to each parameter set in the PM C D area specified by Pa43 (allocation condition setting (for DI/DO)) even if no instruction is provided by the user program.', '2.CYCLIC TRANSMISSION SPECIFICATION B-64164EN/01 - 34 - 2.3 NODE STATE MONITORING 2.3.1 Allocation of Local Node State The state of the local node can be monitored by allocating the 8-byte state code of the local node in the PMC E area or the PMC R area. Related parameters <1> Pa20: Local node status Data structure Local node information is allocated in the PMC E area or the PMC R area as follows: 7 0 ＋0Local node state ＋1FA link state ＋2Upper layer state ＋4Current RCT value ＋6Local node number ＋8 NOTE 1 An 8-byte area is always used 2 When Pa20 (local node status) is not set, local node information is not posted. Local node state: 1 byte 7 6 5 4 3 2 1 0 +0 (Reserved) <1> <2> <3> <4> (Reserved) <4> Token monitoring time error flag (1: Error detected) <3> Initialization error flag (1: Error detected) <2> Reception wait state flag (1: Reception wait state) <1> Duplicate node number flag (1: Duplicate node number detected) Pa20→'], '2.3 NODE STATE MONITORING': ['2.CYCLIC TRANSMISSION SPECIFICATION B-64164EN/01 - 34 - 2.3 NODE STATE MONITORING 2.3.1 Allocation of Local Node State The state of the local node can be monitored by allocating the 8-byte state code of the local node in the PMC E area or the PMC R area. Related parameters <1> Pa20: Local node status Data structure Local node information is allocated in the PMC E area or the PMC R area as follows: 7 0 ＋0Local node state ＋1FA link state ＋2Upper layer state ＋4Current RCT value ＋6Local node number ＋8 NOTE 1 An 8-byte area is always used 2 When Pa20 (local node status) is not set, local node information is not posted. Local node state: 1 byte 7 6 5 4 3 2 1 0 +0 (Reserved) <1> <2> <3> <4> (Reserved) <4> Token monitoring time error flag (1: Error detected) <3> Initialization error flag (1: Error detected) <2> Reception wait state flag (1: Reception wait state) <1> Duplicate node number flag (1: Duplicate node number detected) Pa20→', 'B-64164EN/01 SPECIFICATION 2.CYCLIC TRANSMISSION - 35 - Table 2-1 Local Node State Item Description Token monitoring time error flag Set when transmission does not terminate within the token monitoring time (Pa15) set for the local node. Initialization error flag Set when an initialization parameter or a parameter set again is invalid. Reception wait state flag Set when the node enters the frame reception wait state without receiving any frame during network initialization. Duplicate node number flag Set when a node having the same node number as for the local node is detected in the network. FA link state: 1 byte 7 6 5 4 3 2 1 0 +1 <1> <2> <3> <4> (Reserved) <5> <6> <6> Node participation flag (1: Participate) <5> Communication disable detection flag (1: Detected) <4> Upper layer operation signal error flag (1: Error) <3> Common memory data valid flag (1: Valid) <2> Common memory setting complete flag (1: Complete) <1> Duplicate address detection flag (1: Duplicate address detected) Table 2-2 FA Link State Item Description Node participation flag Set when t he local node participates in the network (communicating with another node). Communication disable detection flag Set when communication is disabled because a device in a different token mode is detected. Upper layer operation signal error flag Currently, not supported. Common memory data valid flag Set when cyclic data is valid, in other words, when PMC area allocation is normal. Common memory setting complete flag Set when common memory setting for the node is completed. This means that this flag is set when the parameters related to the common memory setting (Pa11, Pa12, Pa13, and Pa14) are correct. Duplicate address detection flag Set when a common memory setting for a node connected to the net work is duplicate, in other words, when the value specified for a parameter (Pa11, Pa12, Pa13, or Pa14) for another device is specif ied for a parameter related to the common memory setting (Pa11, Pa12, Pa13, or Pa14).'], '2.3.1 Allocation of Local Node State': ['2.CYCLIC TRANSMISSION SPECIFICATION B-64164EN/01 - 34 - 2.3 NODE STATE MONITORING 2.3.1 Allocation of Local Node State The state of the local node can be monitored by allocating the 8-byte state code of the local node in the PMC E area or the PMC R area. Related parameters <1> Pa20: Local node status Data structure Local node information is allocated in the PMC E area or the PMC R area as follows: 7 0 ＋0Local node state ＋1FA link state ＋2Upper layer state ＋4Current RCT value ＋6Local node number ＋8 NOTE 1 An 8-byte area is always used 2 When Pa20 (local node status) is not set, local node information is not posted. Local node state: 1 byte 7 6 5 4 3 2 1 0 +0 (Reserved) <1> <2> <3> <4> (Reserved) <4> Token monitoring time error flag (1: Error detected) <3> Initialization error flag (1: Error detected) <2> Reception wait state flag (1: Reception wait state) <1> Duplicate node number flag (1: Duplicate node number detected) Pa20→', 'B-64164EN/01 SPECIFICATION 2.CYCLIC TRANSMISSION - 35 - Table 2-1 Local Node State Item Description Token monitoring time error flag Set when transmission does not terminate within the token monitoring time (Pa15) set for the local node. Initialization error flag Set when an initialization parameter or a parameter set again is invalid. Reception wait state flag Set when the node enters the frame reception wait state without receiving any frame during network initialization. Duplicate node number flag Set when a node having the same node number as for the local node is detected in the network. FA link state: 1 byte 7 6 5 4 3 2 1 0 +1 <1> <2> <3> <4> (Reserved) <5> <6> <6> Node participation flag (1: Participate) <5> Communication disable detection flag (1: Detected) <4> Upper layer operation signal error flag (1: Error) <3> Common memory data valid flag (1: Valid) <2> Common memory setting complete flag (1: Complete) <1> Duplicate address detection flag (1: Duplicate address detected) Table 2-2 FA Link State Item Description Node participation flag Set when t he local node participates in the network (communicating with another node). Communication disable detection flag Set when communication is disabled because a device in a different token mode is detected. Upper layer operation signal error flag Currently, not supported. Common memory data valid flag Set when cyclic data is valid, in other words, when PMC area allocation is normal. Common memory setting complete flag Set when common memory setting for the node is completed. This means that this flag is set when the parameters related to the common memory setting (Pa11, Pa12, Pa13, and Pa14) are correct. Duplicate address detection flag Set when a common memory setting for a node connected to the net work is duplicate, in other words, when the value specified for a parameter (Pa11, Pa12, Pa13, or Pa14) for another device is specif ied for a parameter related to the common memory setting (Pa11, Pa12, Pa13, or Pa14).', '2.CYCLIC TRANSMISSION SPECIFICATION B-64164EN/01 - 36 - Upper layer state: 2 bytes 7 6 5 4 3 2 1 0 +2 <8> <9> <10> <11> <12> <13> <14> <15> +3 <1> <2> <3> (Reserved) <4> <5> <6> <7> U_ERR_CODE <4> (Highest bit) to <15> (Lowest bit) (This code is not used with this device.) <2>, <3> U_ERR 00: NORMAL 01: WARNING 1x: ALARM <1> RUN/STOP 0: STOP 1: RUN Table 2-3 Upper Layer State Item Description U_ERR_CODE Current ly, not supported. U_ERR Currently, not supported. RUN/STOP The RUN/STOP state of the 1st PMC ladder program is set. (Note) NOTE When a multi-path PMC is used, the status of the ladder program for the first PMC path is set.', 'B-64164EN/01 SPECIFICATION 2.CYCLIC TRANSMISSION - 37 - Current RCT value: 2 bytes 7 6 5 4 3 2 1 0 +4 <9> <10> <11> <12> <13> <14> <15> <16> +5 <1> <2> <3> <4> <5> <6> <7> <8> Current RCT value: <1> (Highest bit) to <16> (Lowest bit) Table 2-4 Current RCT value Item Description Current RCT value Refresh Cycle Time 120% of the actual time required for a token to circulates among all nodes (refresh cycle measurement time) (unit: 1 ms) Local node number: 2 bytes 7 6 5 4 3 2 1 0 +6 <1> <2> <3> <4> <5> <6> <7> <8> +7 (Reserved) Local node number: <1> (Highest bit) to <8> (Lowest bit) Table 2-5 Local node number Item Description Local node number Node number of the local node (1 to 254)', '2.CYCLIC TRANSMISSION SPECIFICATION B-64164EN/01 - 38 - 2.3.2 Allocation of a List of Participating Nodes A list of the numbers of the nodes participating in the network can be allocated in the PMC E area or the PMC R area to monitor the participation state. Related parameters (1) Pa20: A list of participating nodes Data structure Participating node information as indicated below is allocated in the PMC E area or the PMC R area. Participating node information: 32 bytes 7 6 5 4 3 2 1 0 +0 Node 7 Node 6 Node 5 Node 4 Node 3 Node 2 Node 1 (Reserved) +1 Node 15 Node 14 Node 13 Node 12 Node 11 Node 10 Node 9 Node 8 ： +30 Node 247 Node 246 Node 245 Node 244 Node 243 Node 242 Node 241 Node 240 +31 (Reserved) Node 254 Node 253 Node 252 Node 251 Node 250 Node 249 Node 248 The bits corresponding to the node number of nodes participating in the network (including the local node) are set to 1. CAUTION Usually, machining processing of the CNC is not affected even when the CNC is disconnected from FL-net communication. When the entire system is to be stopped by the detection of a disconnected communication device, however, the CNC operation should be designed according to the system so that, for example, the CNC is placed in the emergency stop state immediately, or that the CNC is stopped after the tool is retracted to an allowable extent. NOTE 1 A 32-byte area is always used. 2 When Pa21 (a list of participating nodes) is not set, participating-node list information is not posted. Pa21→'], '2.3.2 Allocation of a List of Participating Nodes': ['2.CYCLIC TRANSMISSION SPECIFICATION B-64164EN/01 - 38 - 2.3.2 Allocation of a List of Participating Nodes A list of the numbers of the nodes participating in the network can be allocated in the PMC E area or the PMC R area to monitor the participation state. Related parameters (1) Pa20: A list of participating nodes Data structure Participating node information as indicated below is allocated in the PMC E area or the PMC R area. Participating node information: 32 bytes 7 6 5 4 3 2 1 0 +0 Node 7 Node 6 Node 5 Node 4 Node 3 Node 2 Node 1 (Reserved) +1 Node 15 Node 14 Node 13 Node 12 Node 11 Node 10 Node 9 Node 8 ： +30 Node 247 Node 246 Node 245 Node 244 Node 243 Node 242 Node 241 Node 240 +31 (Reserved) Node 254 Node 253 Node 252 Node 251 Node 250 Node 249 Node 248 The bits corresponding to the node number of nodes participating in the network (including the local node) are set to 1. CAUTION Usually, machining processing of the CNC is not affected even when the CNC is disconnected from FL-net communication. When the entire system is to be stopped by the detection of a disconnected communication device, however, the CNC operation should be designed according to the system so that, for example, the CNC is placed in the emergency stop state immediately, or that the CNC is stopped after the tool is retracted to an allowable extent. NOTE 1 A 32-byte area is always used. 2 When Pa21 (a list of participating nodes) is not set, participating-node list information is not posted. Pa21→', 'B-64164EN/01 SPECIFICATION 2.CYCLIC TRANSMISSION - 39 - 2.4 BYTE LIST OF CYCLIC DATA A byte list in a common memory area is related with a byte list in the PMC area as described below. Common memory area and the PMC area On FL-net line Common memory area PMC area 7 0 1 5 0 7 0 +00 12H +00 3412H +00 34H +01 34H +01 7856H +01 12H +02 56H +02 78H +03 78H +03 56H The data list in the PMC area can be changed as shown below by setting bit 0 (CYC) of FL-net parameter Pa60 (parameter 1) to 1: On FL-net line Common memory area PMC area 7 0 1 5 0 7 0 +00 12H +00 3412H +00 12H +01 34H +01 7856H +01 34H +02 56H +02 56H +03 78H +03 78H NOTE The data width of each address in a common memory area of the FL-net is 16 bits. On the other hand, the data width of each address in the PMC area is 8 bits. So, data is exchanged between the common memory areas and the PMC area according to the relationships shown above.'], '2.4 BYTE LIST OF CYCLIC DATA': ['B-64164EN/01 SPECIFICATION 2.CYCLIC TRANSMISSION - 39 - 2.4 BYTE LIST OF CYCLIC DATA A byte list in a common memory area is related with a byte list in the PMC area as described below. Common memory area and the PMC area On FL-net line Common memory area PMC area 7 0 1 5 0 7 0 +00 12H +00 3412H +00 34H +01 34H +01 7856H +01 12H +02 56H +02 78H +03 78H +03 56H The data list in the PMC area can be changed as shown below by setting bit 0 (CYC) of FL-net parameter Pa60 (parameter 1) to 1: On FL-net line Common memory area PMC area 7 0 1 5 0 7 0 +00 12H +00 3412H +00 12H +01 34H +01 7856H +01 34H +02 56H +02 56H +03 78H +03 78H NOTE The data width of each address in a common memory area of the FL-net is 16 bits. On the other hand, the data width of each address in the PMC area is 8 bits. So, data is exchanged between the common memory areas and the PMC area according to the relationships shown above.', '3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 40 - 3 MESSAGE TRANSMISSION This chapter details how to use the message transmission function of the FL-net function.'], '3 MESSAGE TRANSMISSION': ['3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 40 - 3 MESSAGE TRANSMISSION This chapter details how to use the message transmission function of the FL-net function.', 'B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 41 - 3.1 LIST OF MESSAGE TRANSMISSION SERVICES The message transmission function of the FANUC FL-net function supports the services listed in Table 3-1. Table 3-1 List of Services Supported Message service item Client function Server function Byte block read { { Byte block write { { Word block read { { Word block write { { Network parameter read - { Network parameter write - { Stop command - - Start command - - Profile read - { Log data read - { Log data clear - { Transparent message { (Note) { (Note) Echo back message (for test) - { NOTE Among the transaction codes assigned to transparent messages, 50000 to 59999 are used for this transparent message.'], '3.1 LIST OF MESSAGE TRANSMISSION SERVICES': ['B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 41 - 3.1 LIST OF MESSAGE TRANSMISSION SERVICES The message transmission function of the FANUC FL-net function supports the services listed in Table 3-1. Table 3-1 List of Services Supported Message service item Client function Server function Byte block read { { Byte block write { { Word block read { { Word block write { { Network parameter read - { Network parameter write - { Stop command - - Start command - - Profile read - { Log data read - { Log data clear - { Transparent message { (Note) { (Note) Echo back message (for test) - { NOTE Among the transaction codes assigned to transparent messages, 50000 to 59999 are used for this transparent message.', '3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 42 - 3.2 OVERVIEW OF THE MESSAGE TRANSMISSION FUNCTION The function for transmitting messages other than transparent messages involves a client function and server function. For a message transmitted from the client, the server returns a response message. In short, the client is a service requester, and the server is a service receiver. Basically, when the message transmission server function of the FANUC FL-net function receives a request message, the server function automatically returns a response message to the client without involving the user program. With the client function, the user program transmits a message by using the interface area set by Pa50 (client function interface). Client Server User program User program System System FL-net A transparent message can be handled freely by the user program without making a client/server distinction. So, two interface areas are required: one for transmission and the other for reception. As the transmit interface area, the interface area set by Pa50 (client function interface) used with a client m essage is used. As the receive interface area, the interface area set by Pa52 (server function interface) is used. User program User program System System FL-net Request message Response message Message Message'], '3.2 OVERVIEW OF THE MESSAGE TRANSMISSION FUNCTION': ['3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 42 - 3.2 OVERVIEW OF THE MESSAGE TRANSMISSION FUNCTION The function for transmitting messages other than transparent messages involves a client function and server function. For a message transmitted from the client, the server returns a response message. In short, the client is a service requester, and the server is a service receiver. Basically, when the message transmission server function of the FANUC FL-net function receives a request message, the server function automatically returns a response message to the client without involving the user program. With the client function, the user program transmits a message by using the interface area set by Pa50 (client function interface). Client Server User program User program System System FL-net A transparent message can be handled freely by the user program without making a client/server distinction. So, two interface areas are required: one for transmission and the other for reception. As the transmit interface area, the interface area set by Pa50 (client function interface) used with a client m essage is used. As the receive interface area, the interface area set by Pa52 (server function interface) is used. User program User program System System FL-net Request message Response message Message Message', 'B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 43 - The format of each interface area is described below. Transmit interface for the client and transparent messages The interface area specified by Pa50 (client function interface) has the format shown below. 7 0 +0Transmission request/response flag +2Request status (R_STS) +3Response status(M_RLT) +4Cancel flag +5Destination node number +6(Reserved) +8Message section NOTE The message section does not include a data buffer area. Pa50→ Pa51', '3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 44 - Table 3-2 Transmit Interface Items Interface item Description Direction Transmission request/response flag (Note 1, 2) Flag set by the user program to request message transmission, and set by the CNC to post the reception of a response message or the occurrence of an error. 0001h: The user program requests message transmission. 8000h: The system posts the reception of a normal response message. The system posts the transmission of a normal transparent message. 8100h and up: The system posts a request message format error. 8200h and up: The system posts a request message transmission error. 8300h and up: The system posts the reception of an abnormal response message. 8800h: The system posts the acceptance of cancellation from the user program. U→S S→U Request status (R_STS) Status for checking whether a request message has been transmitted to the server (destination node). 01h: A request message has been delivered to the server normally. 02h: Server buffer file 03h: The server is not initialized yet. 05h: Serial number/version number error 06h: Format error S→U Response status (M_RLT) Status for checking a response message 00h: Normal response 01h: Abnormal response 02h: Server service not supported S→U Cancel flag (Note 3) Set a value other than 0 for service cancellation before a message responding to a transmission request is returned. The purpose of this cancellation is just to allow the system to accept the next transmission request. This cancellation is not intended to cancel message transmission with the FL-net function. U→S Destination node number Message transmission destination node number U →S Message section Area for setting a message transaction code, parameters, and so forth. The information set in this area depends on the type of message transmission service. U→S S→U The column of direction in the table above indicates whether each item is posted from the user program to the system (U →S) or is posted from the system to the user program (S →U).', 'B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 45 - NOTE 1 Transmission starts when the user program writes 0001h into the transmission request/response flag. Therefore, set 0001h after setting data in all other interface areas. While the transmission request/response flag is 0001h, the user program must not rewrite data in this interface area. If the content of this area is rewritten, message transmission cannot sometimes end normally. 2 When the message transmission service ends, the system returns 8000h or a larger value to the transmission request/response flag. At the time of normal end, 8000h is returned; at the time of abnormal end, a value other than 8000h is returned. When an abnormal end occurs, check the value and correct the cause. For error codes returned by the system, see Table 3-3. 3 After a message transmission request is made, this interface does not allow the next transmission request to be made until a response message is received or an error occurs. So, if a response message cannot be received for a cause on the server, the next message transmission request cannot be made until the power is turned off. In such a case, the cancel flag allows the system to exit from the response me ssage wait state and wait for the next message transmission request. The purpose of this cancellation is just to allow the system to accept the next message transmission request. This cancellation is not intended to cancel message transmission with the FL-net function. (The FL-net function does not have a function for canceling message transmission.) This means that when this cancellation function is used, the response message for the previous message request may be treated as a response to the next message request by mistake. 4 If a response message is received before ACK is returned in response to a request message, the request status (R_STS) is sometimes not set to 01h.', '3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 46 - Table 3-3 Error Codes of the Transmit Interface Error code 1st byte 2nd byteDescription 01h A specified node number is incorrect. 02h A specified transaction code is incorrect. 03h An area specified as a transmit/receive buffer in the PMC R area exceeds the allowable range. 04h In word block data, an odd address is specified as a transmit/receive buffer area in the PMC R area. 81h 05h Excessive data size 02h Server buffer file 03h The server is not initialized yet. 05h Server serial number/version number error 06h Server format error 82h 10h Retry failure (no response from the server) 01h Abnormal response reception 83h 02h Server service not supported', 'B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 47 - Receive interface for server function and transparent messages The interface area specified by Pa52 (server function interface) has the format shown below. 7 0 +0Receive flag +2Transmission source node number +3(Reserved) +4Transaction code +6Size +8Data Table 3-4 Receive Interface Items Interface item Description Direction Receive flag (Note 3) Flag used by the system to post the reception of a message to the user program. 0001h: The system posts the reception of a message. 0000h: The user program posts the completion of message receive processing. S→U U→S Transmission source node number Message transmission source node number S →U Transaction code Transaction code of a received message S →U Size Number of words of data contained in a received message S→U Data Data contained in a received message S →U NOTE The system sets the receive flag to 0001h when receiving a message to be posted to the user program. The user program must clear this flag to 0 after completing processing on the received message. While this flag is 0001h, the system does not receive another message. Pa52→ Pa53', '3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 48 - 3.3 PROCEDURE FOR MESSAGE TRANSMISSION OPERATION This section explains how the user program exchanges data with the system when messages are transmitted or received through message transmission. 3.3.1 Procedure for Message Transmission Operation Message transmission side (client) User program System 1) Message preparation Each status flag is cleared. 2) Transmission request flag ← 0001h 3) Checking that the transmission request flag is set to 0001h 4) Request message transmission 8) Checking request status 7) ACK reception 11) Response message reception 15) Checking that the response flag is set to 8000h. 12) Response flag ← 8000h 16) Checking response status 13) ACK reception 17) Response message processing 18) Clearing the response flag to 0000h Message reception side (server) User program System 5) request message reception 6) ACK transmission 9) Request message processing 10) Response message transmission 14) ACK reception'], '3.3 PROCEDURE FOR MESSAGE TRANSMISSION OPERATION': ['3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 48 - 3.3 PROCEDURE FOR MESSAGE TRANSMISSION OPERATION This section explains how the user program exchanges data with the system when messages are transmitted or received through message transmission. 3.3.1 Procedure for Message Transmission Operation Message transmission side (client) User program System 1) Message preparation Each status flag is cleared. 2) Transmission request flag ← 0001h 3) Checking that the transmission request flag is set to 0001h 4) Request message transmission 8) Checking request status 7) ACK reception 11) Response message reception 15) Checking that the response flag is set to 8000h. 12) Response flag ← 8000h 16) Checking response status 13) ACK reception 17) Response message processing 18) Clearing the response flag to 0000h Message reception side (server) User program System 5) request message reception 6) ACK transmission 9) Request message processing 10) Response message transmission 14) ACK reception', 'B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 49 - 3.3.2 Procedure for operating the transparent message transmission Because no response message is used for transparent messages, there is no need to wait for a response message. Transparent message transmission side User program System 1) Transparent message preparation Each status flag is cleared. 2) Transmission request flag ← 0001h 3) Checking that the transmission request flag is set to 0001h 4) Transparent message transmission 12) Checking request status 11) ACK reception 14) Checking that the completion flag is set to 8000h 13) Completion flag ← 8000h 15) Clearing the completion flag to 0000h Transparent message reception side User program System 5) Transparent message reception 6) ACK transmission 8) Checking that the receive flag is set to 0001h 7) Receive flag ← 0001h 9) Receive message processing 10) Clearing the receive flag to 0000h'], '3.3.1 Procedure for Message Transmission Operation': ['3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 48 - 3.3 PROCEDURE FOR MESSAGE TRANSMISSION OPERATION This section explains how the user program exchanges data with the system when messages are transmitted or received through message transmission. 3.3.1 Procedure for Message Transmission Operation Message transmission side (client) User program System 1) Message preparation Each status flag is cleared. 2) Transmission request flag ← 0001h 3) Checking that the transmission request flag is set to 0001h 4) Request message transmission 8) Checking request status 7) ACK reception 11) Response message reception 15) Checking that the response flag is set to 8000h. 12) Response flag ← 8000h 16) Checking response status 13) ACK reception 17) Response message processing 18) Clearing the response flag to 0000h Message reception side (server) User program System 5) request message reception 6) ACK transmission 9) Request message processing 10) Response message transmission 14) ACK reception', 'B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 49 - 3.3.2 Procedure for operating the transparent message transmission Because no response message is used for transparent messages, there is no need to wait for a response message. Transparent message transmission side User program System 1) Transparent message preparation Each status flag is cleared. 2) Transmission request flag ← 0001h 3) Checking that the transmission request flag is set to 0001h 4) Transparent message transmission 12) Checking request status 11) ACK reception 14) Checking that the completion flag is set to 8000h 13) Completion flag ← 8000h 15) Clearing the completion flag to 0000h Transparent message reception side User program System 5) Transparent message reception 6) ACK transmission 8) Checking that the receive flag is set to 0001h 7) Receive flag ← 0001h 9) Receive message processing 10) Clearing the receive flag to 0000h'], '3.3.2 Procedure for operating the transparent message transmission': ['B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 49 - 3.3.2 Procedure for operating the transparent message transmission Because no response message is used for transparent messages, there is no need to wait for a response message. Transparent message transmission side User program System 1) Transparent message preparation Each status flag is cleared. 2) Transmission request flag ← 0001h 3) Checking that the transmission request flag is set to 0001h 4) Transparent message transmission 12) Checking request status 11) ACK reception 14) Checking that the completion flag is set to 8000h 13) Completion flag ← 8000h 15) Clearing the completion flag to 0000h Transparent message reception side User program System 5) Transparent message reception 6) ACK transmission 8) Checking that the receive flag is set to 0001h 7) Receive flag ← 0001h 9) Receive message processing 10) Clearing the receive flag to 0000h', '3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 50 - 3.4 MESSAGE TRANSMISSION CLIENT FUNCTION This section explains in detail the interfaces in the message section of each service of the message transmission client function. 3.4.1 Byte Block Read Request message Response message 7 0 7 0 +0 Transmission request flag 0001h +0 Response flag +2 +2 Request status +3 +3 Response status +4 Cancel flag +4 +5 Destination node number +5 +6 (Reserved) +6 (Reserved) +8 Transaction code 65003 +8 Transaction code 65203 +10 (Reserved) +10 (Reserved) +12 Offset address on virtual address space +12 Offset address on virtual address space +16 Data size +16 Data size +18 Read data buffer start address +18 Read data buffer start address +20 +20 (Reserved) Read data Pa50→ Pa51'], '3.4 MESSAGE TRANSMISSION CLIENT FUNCTION': ['3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 50 - 3.4 MESSAGE TRANSMISSION CLIENT FUNCTION This section explains in detail the interfaces in the message section of each service of the message transmission client function. 3.4.1 Byte Block Read Request message Response message 7 0 7 0 +0 Transmission request flag 0001h +0 Response flag +2 +2 Request status +3 +3 Response status +4 Cancel flag +4 +5 Destination node number +5 +6 (Reserved) +6 (Reserved) +8 Transaction code 65003 +8 Transaction code 65203 +10 (Reserved) +10 (Reserved) +12 Offset address on virtual address space +12 Offset address on virtual address space +16 Data size +16 Data size +18 Read data buffer start address +18 Read data buffer start address +20 +20 (Reserved) Read data Pa50→ Pa51', 'B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 51 - Table 3-5 Byte Block Read Interface Items Interface item Description Direction Transaction code Request message: 65003 Response message: 65203 U→S S→U Offset address on virtual address space Request message: Offset address on virtual address space of byte block data to be read from the server Response message: Same as above U→S Data size Request message: Size of byte block data to be read from the server (in bytes) Response message: Size of byte block data actually read from the server (in bytes) U→S S→U Read data buffer start address (Note 1) Request message: Start address of an area in the PMC area used to store byte block data read from the server Response message: Same as above U→S Read data Request message: Reserved Response message: Byte block data actually read from the server. When an abnormal response is returned, an error code is stored. S→U NOTE 1 The read data buffer is allocated to the same PMC area as for this interface. Therefore, when this interface is allocated to the R area of the first PMC, the read data buffer is also allocated to the R area of the first PMC. 2 For an error code stored when an abnormal response is returned, refer to the manual of the equipment of a message transmission destination.'], '3.4.1 Byte Block Read': ['3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 50 - 3.4 MESSAGE TRANSMISSION CLIENT FUNCTION This section explains in detail the interfaces in the message section of each service of the message transmission client function. 3.4.1 Byte Block Read Request message Response message 7 0 7 0 +0 Transmission request flag 0001h +0 Response flag +2 +2 Request status +3 +3 Response status +4 Cancel flag +4 +5 Destination node number +5 +6 (Reserved) +6 (Reserved) +8 Transaction code 65003 +8 Transaction code 65203 +10 (Reserved) +10 (Reserved) +12 Offset address on virtual address space +12 Offset address on virtual address space +16 Data size +16 Data size +18 Read data buffer start address +18 Read data buffer start address +20 +20 (Reserved) Read data Pa50→ Pa51', 'B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 51 - Table 3-5 Byte Block Read Interface Items Interface item Description Direction Transaction code Request message: 65003 Response message: 65203 U→S S→U Offset address on virtual address space Request message: Offset address on virtual address space of byte block data to be read from the server Response message: Same as above U→S Data size Request message: Size of byte block data to be read from the server (in bytes) Response message: Size of byte block data actually read from the server (in bytes) U→S S→U Read data buffer start address (Note 1) Request message: Start address of an area in the PMC area used to store byte block data read from the server Response message: Same as above U→S Read data Request message: Reserved Response message: Byte block data actually read from the server. When an abnormal response is returned, an error code is stored. S→U NOTE 1 The read data buffer is allocated to the same PMC area as for this interface. Therefore, when this interface is allocated to the R area of the first PMC, the read data buffer is also allocated to the R area of the first PMC. 2 For an error code stored when an abnormal response is returned, refer to the manual of the equipment of a message transmission destination.', '3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 52 - 3.4.2 Byte Block Write Request message Response message 7 0 7 0 +0 Transmission request flag 0001h +0 Response flag +2 +2 Request status +3 +3 Response status +4 Cancel flag +4 +5 Destination node number +5 +6 (Reserved) +6 (Reserved) +8 Transaction code 65004 +8 Transaction code 65204 +10 (Reserved) +10 (Reserved) +12 Offset address on virtual address space +12 Offset address on virtual address space +16 Data size +16 Data size +18 Write data buffer start address +18 Write data buffer start address +20 +20 Write data (Reserved) Error code when an abnormal response is returned Pa50→ Pa51'], '3.4.2 Byte Block Write': ['3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 52 - 3.4.2 Byte Block Write Request message Response message 7 0 7 0 +0 Transmission request flag 0001h +0 Response flag +2 +2 Request status +3 +3 Response status +4 Cancel flag +4 +5 Destination node number +5 +6 (Reserved) +6 (Reserved) +8 Transaction code 65004 +8 Transaction code 65204 +10 (Reserved) +10 (Reserved) +12 Offset address on virtual address space +12 Offset address on virtual address space +16 Data size +16 Data size +18 Write data buffer start address +18 Write data buffer start address +20 +20 Write data (Reserved) Error code when an abnormal response is returned Pa50→ Pa51', 'B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 53 - Table 3-6 Byte Block Write Interface Items Interface item Description Direction Transaction code Request message: 65004 Response message: 65204 U→S S→U Offset address on virtual address space Request message: Offset address on virtual address space of byte block data to be written to the server Response message: Same as above U→S Data size Request message: Size of byte block data to be written to the server (in bytes) Response message: Size of byte block data actually written to the server (in bytes) U→S S→U Write data buffer start address (Note 1) Request message: Start address of an area in the PMC area storing byte block data to be written to the server Response message: Same as above U→S Write data Request message: Byte block data to be written to the server Response message: An error code is stored when an abnormal response is returned. U→S S→U NOTE 1 The write data buffer is allocated to the same PMC area as for this interface. Therefore, when this interface is allocated to the R area of the first PMC, the write data buffer is also allocated to the R area of the first PMC. 2 For an error code stored when an abnormal response is returned, refer to the manual of the equipment of a message transmission destination.', '3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 54 - 3.4.3 Word Block Read Request message Response message 7 0 7 0 +0 Transmission request flag 0001h +0 Response flag +2 +2 Request status +3 +3 Response status +4 Cancel flag +4 +5 Destination node number +5 +6 (Reserved) +6 (Reserved) +8 Transaction code 65005 +8 Transaction code 65205 +10 (Reserved) +10 (Reserved) +12 Offset address on virtual address space +12 Offset address on virtual address space +16 Data size +16 Data size +18 Read data buffer start address +18 Read data buffer start address +20 +20 (Reserved) Read data Pa50→ Pa51'], '3.4.3 Word Block Read': ['3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 54 - 3.4.3 Word Block Read Request message Response message 7 0 7 0 +0 Transmission request flag 0001h +0 Response flag +2 +2 Request status +3 +3 Response status +4 Cancel flag +4 +5 Destination node number +5 +6 (Reserved) +6 (Reserved) +8 Transaction code 65005 +8 Transaction code 65205 +10 (Reserved) +10 (Reserved) +12 Offset address on virtual address space +12 Offset address on virtual address space +16 Data size +16 Data size +18 Read data buffer start address +18 Read data buffer start address +20 +20 (Reserved) Read data Pa50→ Pa51', 'B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 55 - Table 3-7 Word Block Read Interface Items Interface item Description Direction Transaction code Request message: 65005 Response message: 65205 U→S S→U Offset address on virtual address space Request message: Offset address on virtual address space of word block data to be read from the server Response message: Same as above U→S Data size Request message: Size of word block data to be read from the server (in words) Response message: Size of word block data actually read from the server (in words) U→S S→U Read data buffer start address (Note 1) Request message: Start address of an area in the PMC area used to store word block data read from the server Response message: Same as above U→S Read data Request message: Reserved Response message: Word block data actually read from the server. When an abnormal response is returned, an error code is stored. S→U NOTE 1 The read data buffer is allocated to the same PMC area as for this interface. Therefore, when this interface is allocated to the R area of the first PMC, the read data buffer is also allocated to the R area of the first PMC. 2 or an error code stored when an abnormal response is returned, refer to the manual of the equipment of a message transmission destination.', '3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 56 - 3.4.4 Word Block Write Request message Response message 7 0 7 0 +0 Transmission request flag 0001h +0 Response flag +2 +2 Request status +3 +3 Response status +4 Cancel flag +4 +5 Destination node number +5 +6 (Reserved) +6 (Reserved) +8 Transaction code 65006 +8 Transaction code 65206 +10 (Reserved) +10 (Reserved) +12 Offset address on virtual address space +12 Offset address on virtual address space +16 Data size +16 Data size +18 Write data buffer start address +18 Write data buffer start address +20 +20 Write data (Reserved) Error code when an abnormal response is returned Pa50→ Pa51'], '3.4.4 Word Block Write': ['3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 56 - 3.4.4 Word Block Write Request message Response message 7 0 7 0 +0 Transmission request flag 0001h +0 Response flag +2 +2 Request status +3 +3 Response status +4 Cancel flag +4 +5 Destination node number +5 +6 (Reserved) +6 (Reserved) +8 Transaction code 65006 +8 Transaction code 65206 +10 (Reserved) +10 (Reserved) +12 Offset address on virtual address space +12 Offset address on virtual address space +16 Data size +16 Data size +18 Write data buffer start address +18 Write data buffer start address +20 +20 Write data (Reserved) Error code when an abnormal response is returned Pa50→ Pa51', 'B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 57 - Table 3-8 Word Block Write Interface Items Interface item Description Direction Transaction code Request message: 65006 Response message: 65206 U→S S→U Offset address on virtual address space Request message: Offset address on virtual address space of word block data to be written to the server Response message: Same as above U→S Data size Request message: Si ze of word block data to be written to the server (in words) Response message: Size of word block data actually written to the server (in words) U→S S→U Write data buffer start address (Note 1)Request message: Start address of an area in the PMC R area storing word block data to be written to the server Response message: Same as above U→S Write data Request message: Word block data to be written to the server Response message: An error code is stored when an abnormal response is returned. U→S S→U NOTE 1 The write data buffer is allocated to the same PMC area as for this interface. Therefore, when this interface is allocated to the R area of the first PMC, the write data buffer is also allocated to the R area of the first PMC. 2 For an error code stored when an abnormal response is returned, refer to the manual of the equipment of a message transmission destination.', '3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 58 - 3.5 MESSAGE TRANSMISSION SERVER FUNCTION 3.5.1 Error Code List In response to a request from a c lient, the message data transmission server function automatically returns a response message without involving the user program. When the message transmission server detects an abnormality, the FANUC FL-net function returns one of the following error codes to the client: Table 3-9 List of Server Function Error Codes Error code 1st byte 2nd byteDescription 01h An attempt was made to access a nonexistent PMC area. 02h A specified data size exceeded 1024 bytes. 03h An attempt to allocate a parameter storage area failed. 80h 04h A request was made to write to a write-prohibited area.'], '3.5 MESSAGE TRANSMISSION SERVER FUNCTION': ['3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 58 - 3.5 MESSAGE TRANSMISSION SERVER FUNCTION 3.5.1 Error Code List In response to a request from a c lient, the message data transmission server function automatically returns a response message without involving the user program. When the message transmission server detects an abnormality, the FANUC FL-net function returns one of the following error codes to the client: Table 3-9 List of Server Function Error Codes Error code 1st byte 2nd byteDescription 01h An attempt was made to access a nonexistent PMC area. 02h A specified data size exceeded 1024 bytes. 03h An attempt to allocate a parameter storage area failed. 80h 04h A request was made to write to a write-prohibited area.', 'B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 59 - 3.5.2 Virtual Address Space Allocation Virtual address space used to read/write byte block and read/write word block is allocated in th e PMC area as described below. Virtual address space for byte block data Table 3-10 Virtual Address Space for Byte Block Data Allocation in PMC Symbol Type of signal Address (decimal) Virtual address space (hexadecimal) Remarks X Signal from machine to PMC X0000 or higher 00000000h or higher Read only Y Signal from PMC to machine Y0000 or higher 00004000h or higher Read only F Signal from CNC to PMC F0000 or higher 00008000h or higher Read only G Signal from PMC to CNC G0000 or higher 0000C000h or higher Read only R Internal relay R0000 or higher 00010000h or higher Read/write D Data table D0000 or higher 00014000h or higher Read/write1st PMC E Extra relay E0000 or higher 00018000h or higher Read/write X Signal from machine to PMC X0000 or higher 00100000h or higher Read only Y Signal from PMC to machine Y0000 or higher 00104000h or higher Read only F Signal from CNC to PMC F0000 or higher 00108000h or higher Read only G Signal from PMC to CNC G0000 or higher 0010C000h or higher Read only R Internal relay R0000 or higher 00110000h or higher Read/write D Data table D0000 or higher 00114000h or higher Read/write2nd PMC E Extra relay E0000 or higher 00118000h or higher Read/write X Signal from machine to PMC X0000 or higher 00200000h or higher Read only Y Signal from PMC to machine Y0000 or higher 00204000h or higher Read only F Signal from CNC to PMC F0000 or higher 00208000h or higher Read only G Signal from PMC to CNC G0000 or higher 0020C000h or higher Read only R Internal relay R0000 or higher 00210000h or higher Read/write D Data table D0000 or higher 00214000h or higher Read/write3rd PMC E Extra relay E0000 or higher 00218000h or higher Read/write NOTE 1 The first PMC to third PMC depend on the PMC option configuration. An attempt to access nonexistent PMC space results in an error. 2 Only installed address space in the PMC can be accessed. Check PMC address space before use.'], '3.5.1 Error Code List': ['3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 58 - 3.5 MESSAGE TRANSMISSION SERVER FUNCTION 3.5.1 Error Code List In response to a request from a c lient, the message data transmission server function automatically returns a response message without involving the user program. When the message transmission server detects an abnormality, the FANUC FL-net function returns one of the following error codes to the client: Table 3-9 List of Server Function Error Codes Error code 1st byte 2nd byteDescription 01h An attempt was made to access a nonexistent PMC area. 02h A specified data size exceeded 1024 bytes. 03h An attempt to allocate a parameter storage area failed. 80h 04h A request was made to write to a write-prohibited area.', 'B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 59 - 3.5.2 Virtual Address Space Allocation Virtual address space used to read/write byte block and read/write word block is allocated in th e PMC area as described below. Virtual address space for byte block data Table 3-10 Virtual Address Space for Byte Block Data Allocation in PMC Symbol Type of signal Address (decimal) Virtual address space (hexadecimal) Remarks X Signal from machine to PMC X0000 or higher 00000000h or higher Read only Y Signal from PMC to machine Y0000 or higher 00004000h or higher Read only F Signal from CNC to PMC F0000 or higher 00008000h or higher Read only G Signal from PMC to CNC G0000 or higher 0000C000h or higher Read only R Internal relay R0000 or higher 00010000h or higher Read/write D Data table D0000 or higher 00014000h or higher Read/write1st PMC E Extra relay E0000 or higher 00018000h or higher Read/write X Signal from machine to PMC X0000 or higher 00100000h or higher Read only Y Signal from PMC to machine Y0000 or higher 00104000h or higher Read only F Signal from CNC to PMC F0000 or higher 00108000h or higher Read only G Signal from PMC to CNC G0000 or higher 0010C000h or higher Read only R Internal relay R0000 or higher 00110000h or higher Read/write D Data table D0000 or higher 00114000h or higher Read/write2nd PMC E Extra relay E0000 or higher 00118000h or higher Read/write X Signal from machine to PMC X0000 or higher 00200000h or higher Read only Y Signal from PMC to machine Y0000 or higher 00204000h or higher Read only F Signal from CNC to PMC F0000 or higher 00208000h or higher Read only G Signal from PMC to CNC G0000 or higher 0020C000h or higher Read only R Internal relay R0000 or higher 00210000h or higher Read/write D Data table D0000 or higher 00214000h or higher Read/write3rd PMC E Extra relay E0000 or higher 00218000h or higher Read/write NOTE 1 The first PMC to third PMC depend on the PMC option configuration. An attempt to access nonexistent PMC space results in an error. 2 Only installed address space in the PMC can be accessed. Check PMC address space before use.'], '3.5.2 Virtual Address Space Allocation': ['B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 59 - 3.5.2 Virtual Address Space Allocation Virtual address space used to read/write byte block and read/write word block is allocated in th e PMC area as described below. Virtual address space for byte block data Table 3-10 Virtual Address Space for Byte Block Data Allocation in PMC Symbol Type of signal Address (decimal) Virtual address space (hexadecimal) Remarks X Signal from machine to PMC X0000 or higher 00000000h or higher Read only Y Signal from PMC to machine Y0000 or higher 00004000h or higher Read only F Signal from CNC to PMC F0000 or higher 00008000h or higher Read only G Signal from PMC to CNC G0000 or higher 0000C000h or higher Read only R Internal relay R0000 or higher 00010000h or higher Read/write D Data table D0000 or higher 00014000h or higher Read/write1st PMC E Extra relay E0000 or higher 00018000h or higher Read/write X Signal from machine to PMC X0000 or higher 00100000h or higher Read only Y Signal from PMC to machine Y0000 or higher 00104000h or higher Read only F Signal from CNC to PMC F0000 or higher 00108000h or higher Read only G Signal from PMC to CNC G0000 or higher 0010C000h or higher Read only R Internal relay R0000 or higher 00110000h or higher Read/write D Data table D0000 or higher 00114000h or higher Read/write2nd PMC E Extra relay E0000 or higher 00118000h or higher Read/write X Signal from machine to PMC X0000 or higher 00200000h or higher Read only Y Signal from PMC to machine Y0000 or higher 00204000h or higher Read only F Signal from CNC to PMC F0000 or higher 00208000h or higher Read only G Signal from PMC to CNC G0000 or higher 0020C000h or higher Read only R Internal relay R0000 or higher 00210000h or higher Read/write D Data table D0000 or higher 00214000h or higher Read/write3rd PMC E Extra relay E0000 or higher 00218000h or higher Read/write NOTE 1 The first PMC to third PMC depend on the PMC option configuration. An attempt to access nonexistent PMC space results in an error. 2 Only installed address space in the PMC can be accessed. Check PMC address space before use.', '3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 60 - Virtual address space for word block data Table 3-11 Virtual Address Space for Word Block Data Allocation in PMC Symbol Type of signal Address (decimal) Virtual address space (hexadecimal) Remarks X Signal from machine to PMC X0000 or higher 00000000h or higher Read only Y Signal from PMC to machine Y0000 or higher 00002000h or higher Read only F Signal from CNC to PMC F0000 or higher 00004000h or higher Read only G Signal from PMC to CNC G0000 or higher 00006000h or higher Read only R Internal relay R0000 or higher 00008000h or higher Read/write D Data table D0000 or higher 0000A000h or higher Read/write 1st PMC E Extra relay E0000 or higher 0000C000h or higher Read/write X Signal from machine to PMC X0000 or higher 00100000h or higher Read only Y Signal from PMC to machine Y0000 or higher 00102000h or higher Read only F Signal from CNC to PMC F0000 or higher 00104000h or higher Read only G Signal from PMC to CNC G0000 or higher 00106000h or higher Read only R Internal relay R0000 or higher 00108000h or higher Read/write D Data table D0000 or higher 0010A000h or higher Read/write 2nd PMC E Extra relay E0000 or higher 0010C000h or higher Read/write X Signal from machine to PMC X0000 or higher 00200000h or higher Read only Y Signal from PMC to machine Y0000 or higher 00202000h or higher Read only F Signal from CNC to PMC F0000 or higher 00204000h or higher Read only G Signal from PMC to CNC G0000 or higher 00206000h or higher Read only R Internal relay R0000 or higher 00208000h or higher Read/write D Data table D0000 or higher 0020A000h or higher Read/write 3rd PMC E Extra relay E0000 or higher 0020C000h or higher Read/write NOTE 1 The first PMC to third PMC depend on the PMC option configuration. An attempt to access nonexistent PMC space results in an error. 2 Only installed address space in the PMC can be accessed. Check PMC address space before use.', 'B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 61 - 3.6 TRANSPARENT MESSAGE TRANSMISSION FUNCTION With the FANUC FL-net function, a transparent message of a transaction code (50000 to 59999) can be used as a transparent message for data transmission/reception by the user program. This section explains in detail the interfaces of the transparent message transmission function in the message section at transmission and at reception. 3.6.1 Transparent Message Transmission Transmission request Transmission completed 7 0 7 0 +0 Transmission request flag 0001h +0 Completion flag +2 +2 Request status +3 (Reserved) +3 +4 Cancel flag +4 +5 Destination node number +5 +6 (Reserved) +6 (Reserved) +8 Transaction code 50000 to 59999 +8 Transaction code 50000 to 59999 +10 (Reserved) +10 (Reserved) +16 Data size +16 Data size +18 Transmit data buffer start address +18 Transmit data buffer start address +20 +20 Transparent transmit data (Reserved) NOTE When the destination node number is set to 255, the message is transmitted to all nodes. Pa50→ Pa51'], '3.6 TRANSPARENT MESSAGE TRANSMISSION FUNCTION': ['B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 61 - 3.6 TRANSPARENT MESSAGE TRANSMISSION FUNCTION With the FANUC FL-net function, a transparent message of a transaction code (50000 to 59999) can be used as a transparent message for data transmission/reception by the user program. This section explains in detail the interfaces of the transparent message transmission function in the message section at transmission and at reception. 3.6.1 Transparent Message Transmission Transmission request Transmission completed 7 0 7 0 +0 Transmission request flag 0001h +0 Completion flag +2 +2 Request status +3 (Reserved) +3 +4 Cancel flag +4 +5 Destination node number +5 +6 (Reserved) +6 (Reserved) +8 Transaction code 50000 to 59999 +8 Transaction code 50000 to 59999 +10 (Reserved) +10 (Reserved) +16 Data size +16 Data size +18 Transmit data buffer start address +18 Transmit data buffer start address +20 +20 Transparent transmit data (Reserved) NOTE When the destination node number is set to 255, the message is transmitted to all nodes. Pa50→ Pa51', '3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 62 - Table 3-12 Transparent Transmit Message Interface Items Interface item Description Direction Transaction code 50000 to 59999 U→S Data size Size of transparent data to be transmitted (in words) U→S Transmit data buffer start address (Note) Start address of an area in the PMC area storing transparent data to be transmitted U→S Transparent transmit data Transparent data to be transmitted U→S NOTE The transmission data buffer is allocated to the same PMC area as for this interface. Therefore, when this interface is allocated to the R area of the first PMC, the transmission data buffer is also allocated to the R area of the first PMC.'], '3.6.1 Transparent Message Transmission': ['B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 61 - 3.6 TRANSPARENT MESSAGE TRANSMISSION FUNCTION With the FANUC FL-net function, a transparent message of a transaction code (50000 to 59999) can be used as a transparent message for data transmission/reception by the user program. This section explains in detail the interfaces of the transparent message transmission function in the message section at transmission and at reception. 3.6.1 Transparent Message Transmission Transmission request Transmission completed 7 0 7 0 +0 Transmission request flag 0001h +0 Completion flag +2 +2 Request status +3 (Reserved) +3 +4 Cancel flag +4 +5 Destination node number +5 +6 (Reserved) +6 (Reserved) +8 Transaction code 50000 to 59999 +8 Transaction code 50000 to 59999 +10 (Reserved) +10 (Reserved) +16 Data size +16 Data size +18 Transmit data buffer start address +18 Transmit data buffer start address +20 +20 Transparent transmit data (Reserved) NOTE When the destination node number is set to 255, the message is transmitted to all nodes. Pa50→ Pa51', '3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 62 - Table 3-12 Transparent Transmit Message Interface Items Interface item Description Direction Transaction code 50000 to 59999 U→S Data size Size of transparent data to be transmitted (in words) U→S Transmit data buffer start address (Note) Start address of an area in the PMC area storing transparent data to be transmitted U→S Transparent transmit data Transparent data to be transmitted U→S NOTE The transmission data buffer is allocated to the same PMC area as for this interface. Therefore, when this interface is allocated to the R area of the first PMC, the transmission data buffer is also allocated to the R area of the first PMC.', 'B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 63 - 3.6.2 Transparent Message Reception Reception posted Re ception confirmed 7 0 7 0 +0 Receive flag 0001h +0 Completion flag 0000h +2 Transmission source node number +2 +3 (Reserved) +3 +4 Transaction code 50000 to 59999 +4 Transaction code 50000 to 59999 +6 Data size +6 Data size +8 Transparent receive data +8 Transparent receive data Table 3-13 Transparent Receive Message Interface Items Interface item Description Direction Receive flag / completion flag When a transparent message is received, this flag is set to 0001h after the interface items below are set. The user program must clear this flag to 0 after completing reception processing for the transparent message. S→U U→S Transmission source node number Node number of a transmission source that transmitted a transparent message S→U Transaction code 50000 to 59999 S→U Data size Size of received transparent data (in words) S→U Transparent receive data Transparent data received S→U When a transparent message is received, a R_STS code with a meaning indicated below may be re turned to the transparent message transmission client. Table 3-14 Meanings of R_STS Codes Returned to the Transparent Message Transmission Side R_STS value Description 02 (buffer full) The previously received transparent message is not processed by the user program. 03 (not initialized) An interface area for receiving a transparent message is not allocated. 06 (format error) A transparent mess age actually received is larger than a receive data area allo cated by this interface. Transparent data actually received consists of an odd number of bytes. Pa52→ Pa53'], '3.6.2 Transparent Message Reception': ['B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 63 - 3.6.2 Transparent Message Reception Reception posted Re ception confirmed 7 0 7 0 +0 Receive flag 0001h +0 Completion flag 0000h +2 Transmission source node number +2 +3 (Reserved) +3 +4 Transaction code 50000 to 59999 +4 Transaction code 50000 to 59999 +6 Data size +6 Data size +8 Transparent receive data +8 Transparent receive data Table 3-13 Transparent Receive Message Interface Items Interface item Description Direction Receive flag / completion flag When a transparent message is received, this flag is set to 0001h after the interface items below are set. The user program must clear this flag to 0 after completing reception processing for the transparent message. S→U U→S Transmission source node number Node number of a transmission source that transmitted a transparent message S→U Transaction code 50000 to 59999 S→U Data size Size of received transparent data (in words) S→U Transparent receive data Transparent data received S→U When a transparent message is received, a R_STS code with a meaning indicated below may be re turned to the transparent message transmission client. Table 3-14 Meanings of R_STS Codes Returned to the Transparent Message Transmission Side R_STS value Description 02 (buffer full) The previously received transparent message is not processed by the user program. 03 (not initialized) An interface area for receiving a transparent message is not allocated. 06 (format error) A transparent mess age actually received is larger than a receive data area allo cated by this interface. Transparent data actually received consists of an odd number of bytes. Pa52→ Pa53', '3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 64 - 3.7 SERVER FUNCTION OF TRANSMITTING A MESSAGE WITH CONFIRMATION When an ordinary byte block read/write or word block read/write service of the message transmission server function is executed, data is exchanged with the client without user-program intervention. Data can also be exchanged with user-p rogram intervention using a specific virtual address space specification. This specification can be used to establish the concurrency of data tens to hundreds of bytes long easily. In this case, the user program must transmit a response message, however. This section details the interfaces used for transmission and reception using the function of transmitting a message with confirmation. These interfaces use the transmission and reception areas for transparent message transmission. To perform transmission of a message with confirmation, specify an address with an offset of 01000000h in the ordinary virtual address space. NOTE In message transmission with confirmation, the server must return a response message through the user program. Unle ss the user program on the server side returns a response message, the client cannot complete the message transmission operation.'], '3.7 SERVER FUNCTION OF TRANSMITTING A MESSAGE WITH CONFIRMATION': ['3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 64 - 3.7 SERVER FUNCTION OF TRANSMITTING A MESSAGE WITH CONFIRMATION When an ordinary byte block read/write or word block read/write service of the message transmission server function is executed, data is exchanged with the client without user-program intervention. Data can also be exchanged with user-p rogram intervention using a specific virtual address space specification. This specification can be used to establish the concurrency of data tens to hundreds of bytes long easily. In this case, the user program must transmit a response message, however. This section details the interfaces used for transmission and reception using the function of transmitting a message with confirmation. These interfaces use the transmission and reception areas for transparent message transmission. To perform transmission of a message with confirmation, specify an address with an offset of 01000000h in the ordinary virtual address space. NOTE In message transmission with confirmation, the server must return a response message through the user program. Unle ss the user program on the server side returns a response message, the client cannot complete the message transmission operation.', 'B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 65 - 3.7.1 Reception of a Message with Confirmation Reception posted Re ception confirmed 7 0 7 0 +0Receive flag 0001h +0Completion flag 0000h +2Transmission source node number +2 +3(Reserved) +3 +4Transaction code 65003 to 65006 +4Transaction code 65003 to 65006 +6Data size +6Data size +8Offset address on virtual address space +8Offset address on virtual address space +12 +12 Table 3-15 Receive Message Interface Items Interface item Description Direction Receive flag / completion flag When a message is received, this flag is set to 0001h after the interface items below are set. The user program must clear this flag to 0 after completing message reception processing. S→U U→S Transmission source node number Number of the node which transmitted a message S→U Transaction code 65003 to 65006 S→U Data size Size of received message data S→U Offset address on virtual address space Offset address on virtual address space S→U When a message with confirmation is received, an R_STS code with a meaning indicated below may be re turned to the message transmission client. Table 3-16 Meanings of R_STS Codes Returned to the Transmission Side of Transmission of a Message with Confirmation R_STS value Description 02 (buffer full) The previously re ceived message is not processed by the user program. 03 (not initialized) An interface ar ea for receiving a message is not allocated. 06 (format error) A message actually received is larger than a receive data area allocated by this interface. Word block data actually received consists of an odd number of bytes. Pa52→ Pa53'], '3.7.1 Reception of a Message with Confirmation': ['B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 65 - 3.7.1 Reception of a Message with Confirmation Reception posted Re ception confirmed 7 0 7 0 +0Receive flag 0001h +0Completion flag 0000h +2Transmission source node number +2 +3(Reserved) +3 +4Transaction code 65003 to 65006 +4Transaction code 65003 to 65006 +6Data size +6Data size +8Offset address on virtual address space +8Offset address on virtual address space +12 +12 Table 3-15 Receive Message Interface Items Interface item Description Direction Receive flag / completion flag When a message is received, this flag is set to 0001h after the interface items below are set. The user program must clear this flag to 0 after completing message reception processing. S→U U→S Transmission source node number Number of the node which transmitted a message S→U Transaction code 65003 to 65006 S→U Data size Size of received message data S→U Offset address on virtual address space Offset address on virtual address space S→U When a message with confirmation is received, an R_STS code with a meaning indicated below may be re turned to the message transmission client. Table 3-16 Meanings of R_STS Codes Returned to the Transmission Side of Transmission of a Message with Confirmation R_STS value Description 02 (buffer full) The previously re ceived message is not processed by the user program. 03 (not initialized) An interface ar ea for receiving a message is not allocated. 06 (format error) A message actually received is larger than a receive data area allocated by this interface. Word block data actually received consists of an odd number of bytes. Pa52→ Pa53', '3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 66 - 3.7.2 Response Message Transmission Transmission requested Transmission completed 7 0 7 0 +0Transmission request flag 0001h +0Completion flag +2 +2Request status +3 +3 +4Cancel flag +4 +5Destination node number +5 +6(Reserved) +6(Reserved) +8Transaction code 65203 to 65206 +8Transaction code 65203 to 65206 +10(Reserved) +10(Reserved) +12Offset address on virtual address space +12Offset address on virtual address space +16Data size +16Data size +18 +18 Table 3-17 Response Message Interface Items Interface item Description Direction Transaction code 65203 to 65206 U→S Offset address on virtual address space Offset address on virtual address space U→S Data size Size of data to be transmitted U→S NOTE The procedure for transmission of a message with confirmation is the same as for the transparent message transmission function. Pa50→ Pa51'], '3.7.2 Response Message Transmission': ['3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 66 - 3.7.2 Response Message Transmission Transmission requested Transmission completed 7 0 7 0 +0Transmission request flag 0001h +0Completion flag +2 +2Request status +3 +3 +4Cancel flag +4 +5Destination node number +5 +6(Reserved) +6(Reserved) +8Transaction code 65203 to 65206 +8Transaction code 65203 to 65206 +10(Reserved) +10(Reserved) +12Offset address on virtual address space +12Offset address on virtual address space +16Data size +16Data size +18 +18 Table 3-17 Response Message Interface Items Interface item Description Direction Transaction code 65203 to 65206 U→S Offset address on virtual address space Offset address on virtual address space U→S Data size Size of data to be transmitted U→S NOTE The procedure for transmission of a message with confirmation is the same as for the transparent message transmission function. Pa50→ Pa51', 'B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 67 - 3.7.3 Virtual Address Space Allocation Virtual address space used for byte block read/write and word block read/write with confirmation is a llocated in the PMC area as described below. Virtual address space for byte block data with confirmation Table 3-18 Virtual Address Space for Byte Block Data with Confirmation Allocation in PMC Symbol Type of signal Address (decimal) Virtual address space (hexadecimal) Remarks X Signal from machine to PMC X0000 or higher 01000000h or higher Read only Y Signal from PMC to machine Y0000 or higher 01004000h or higher Read only F Signal from CNC to PMC F0000 or higher 01008000h or higher Read only G Signal from PMC to CNC G0000 or higher 0100C000h or higher Read only R Internal relay R0000 or higher 01010000h or higher Read/write D Data table D0000 or higher 01014000h or higher Read/write1st PMC E Extra relay E0000 or higher 01018000h or higher Read/write X Signal from machine to PMC X0000 or higher 01100000h or higher Read only Y Signal from PMC to machine Y0000 or higher 01104000h or higher Read only F Signal from CNC to PMC F0000 or higher 01108000h or higher Read only G Signal from PMC to CNC G0000 or higher 0110C000h or higher Read only R Internal relay R0000 or higher 01110000h or higher Read/write D Data table D0000 or higher 01114000h or higher Read/write2nd PMC E Extra relay E0000 or higher 01118000h or higher Read/write X Signal from machine to PMC X0000 or higher 01200000h or higher Read only Y Signal from PMC to machine Y0000 or higher 01204000h or higher Read only F Signal from CNC to PMC F0000 or higher 01208000h or higher Read only G Signal from PMC to CNC G0000 or higher 0120C000h or higher Read only R Internal relay R0000 or higher 01210000h or higher Read/write D Data table D0000 or higher 01214000h or higher Read/write3rd PMC E Extra relay E0000 or higher 01218000h or higher Read/write NOTE 1 The first PMC to third PMC depend on the PMC option configuration. An attempt to access nonexistent PMC space results in an error. 2 Only installed address space in the PMC can be accessed. Check PMC address space before use.'], '3.7.3 Virtual Address Space Allocation': ['B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 67 - 3.7.3 Virtual Address Space Allocation Virtual address space used for byte block read/write and word block read/write with confirmation is a llocated in the PMC area as described below. Virtual address space for byte block data with confirmation Table 3-18 Virtual Address Space for Byte Block Data with Confirmation Allocation in PMC Symbol Type of signal Address (decimal) Virtual address space (hexadecimal) Remarks X Signal from machine to PMC X0000 or higher 01000000h or higher Read only Y Signal from PMC to machine Y0000 or higher 01004000h or higher Read only F Signal from CNC to PMC F0000 or higher 01008000h or higher Read only G Signal from PMC to CNC G0000 or higher 0100C000h or higher Read only R Internal relay R0000 or higher 01010000h or higher Read/write D Data table D0000 or higher 01014000h or higher Read/write1st PMC E Extra relay E0000 or higher 01018000h or higher Read/write X Signal from machine to PMC X0000 or higher 01100000h or higher Read only Y Signal from PMC to machine Y0000 or higher 01104000h or higher Read only F Signal from CNC to PMC F0000 or higher 01108000h or higher Read only G Signal from PMC to CNC G0000 or higher 0110C000h or higher Read only R Internal relay R0000 or higher 01110000h or higher Read/write D Data table D0000 or higher 01114000h or higher Read/write2nd PMC E Extra relay E0000 or higher 01118000h or higher Read/write X Signal from machine to PMC X0000 or higher 01200000h or higher Read only Y Signal from PMC to machine Y0000 or higher 01204000h or higher Read only F Signal from CNC to PMC F0000 or higher 01208000h or higher Read only G Signal from PMC to CNC G0000 or higher 0120C000h or higher Read only R Internal relay R0000 or higher 01210000h or higher Read/write D Data table D0000 or higher 01214000h or higher Read/write3rd PMC E Extra relay E0000 or higher 01218000h or higher Read/write NOTE 1 The first PMC to third PMC depend on the PMC option configuration. An attempt to access nonexistent PMC space results in an error. 2 Only installed address space in the PMC can be accessed. Check PMC address space before use.', '3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 68 - Virtual address space for word block data with confirmation Table 3-1 Virtual Address Space for Word Block Data with Confirmation Allocation in PMC Symbol Type of signal Address (decimal) Virtual address space (hexadecimal) Symbol Remarks Type of signal X Signal from machine to PMC X0000or higher 01000000hor higher Read only Y Signal from PMC to machine Y0000or higher 01002000hor higher Read only F Signal from CNC to PMC F0000or higher 01004000hor higher Read only G Signal from PMC to CNC G0000or higher 01006000hor higher Read only R Internal relay R0000or higher 01008000hor higher Read/write D Data table D0000or higher 0100A000hor higher Read/write1st PMC E Extra relay E0000or higher 0100C000hor higher Read/write X Signal from machine to PMC X0000or higher 01100000hor higher Read only Y Signal from PMC to machine Y0000or higher 01102000hor higher Read only F Signal from CNC to PMC F0000or higher 01104000hor higher Read only G Signal from PMC to CNC G0000or higher 01106000hor higher Read only R Internal relay R0000or higher 01108000hor higher Read/write D Data table D0000or higher 0110A000hor higher Read/write2nd PMC E Extra relay E0000or higher 0110C000hor higher Read/write X Signal from machine to PMC X0000or higher 01200000hor higher Read only Y Signal from PMC to machine Y0000or higher 01202000hor higher Read only F Signal from CNC to PMC F0000or higher 01204000hor higher Read only G Signal from PMC to CNC G0000or higher 01206000hor higher Read only R Internal relay R0000or higher 01208000hor higher Read/write D Data table D0000or higher 0120A000hor higher Read/write3rd PMC E Extra relay E0000or higher 0120C000hor higher Read/write NOTE 1 The first PMC to third PMC depend on the PMC option configuration. An attempt to access nonexistent PMC space results in an error. 2 Only installed address space in the PMC can be accessed. Check PMC address space before use.', 'B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 69 - 3.8 BYTE LIST OF MESSAGE DATA In message transmission, the relationships between the sequence of data transmission over the network and the byte list in the virtual address space and PMC area are shown below. Byte block data and the PMC area On FL-net line Virtual address space PMC area 7 0 7 0 7 0 +00 12H +00 12H +00 12H +01 34H +01 34H +01 34H +02 56H +02 56H +02 56H +03 78H +03 78H +03 78H The data list in the PMC area can be changed as shown below by setting bit 2 of FL-net parameter Pa60 (parameter 1) to 1. On FL-net line Virtual address space PMC area 7 0 7 0 7 0 +00 12H +00 12H +00 34H +01 34H +01 34H +01 12H +02 56H +02 56H +02 78H +03 78H +03 78H +03 56H'], '3.8 BYTE LIST OF MESSAGE DATA': ['B-64164EN/01 SPECIFICATION 3.MESSAGE TRANSMISSION - 69 - 3.8 BYTE LIST OF MESSAGE DATA In message transmission, the relationships between the sequence of data transmission over the network and the byte list in the virtual address space and PMC area are shown below. Byte block data and the PMC area On FL-net line Virtual address space PMC area 7 0 7 0 7 0 +00 12H +00 12H +00 12H +01 34H +01 34H +01 34H +02 56H +02 56H +02 56H +03 78H +03 78H +03 78H The data list in the PMC area can be changed as shown below by setting bit 2 of FL-net parameter Pa60 (parameter 1) to 1. On FL-net line Virtual address space PMC area 7 0 7 0 7 0 +00 12H +00 12H +00 34H +01 34H +01 34H +01 12H +02 56H +02 56H +02 78H +03 78H +03 78H +03 56H', '3.MESSAGE TRANSMISSION SPECIFICATION B-64164EN/01 - 70 - Word block data and the PMC area Transparent data and the PMC area On FL-net line Virtual address space PMC area 7 0 1 5 0 7 0 +00 12H +00 3412H +00 34H +01 34H +01 7856H +01 12H +02 56H +02 78H +03 78H +03 56H The data list in the PMC area can be changed as shown below by setting bit 1 of FL-net parameter Pa60 (parameter 1) to 1. On FL-net line Virtual address space PMC area 7 0 1 5 0 7 0 +00 12H +00 3412H +00 12H +01 34H +01 7856H +01 34H +02 56H +02 56H +03 78H +03 78H NOTE The data width of FL-net word block data and transparent messages in the virtual address space is 16 bits. On the other hand, the data width of each address in the PMC area is 8 bits. So, the relationships indicated above apply when data is exchanged between FL-net messages and the PMC area.', 'III. SETTING', '', 'B-64164EN/01 SETTING 1.SETTING OF FL-net FUNCTION - 73 - 1 SETTING OF FL-net FUNCTION This part describes how to set the FL-net function CAUTION After setting DI/DO data, make sure communication is performed correctly in a state in which security is retained. Operating the system without confirmation may cause a serious failure.'], 'III. SETTING': ['B-64164EN/01 SETTING 1.SETTING OF FL-net FUNCTION - 73 - 1 SETTING OF FL-net FUNCTION This part describes how to set the FL-net function CAUTION After setting DI/DO data, make sure communication is performed correctly in a state in which security is retained. Operating the system without confirmation may cause a serious failure.', '1.SETTING OF FL-net FUNCTION SETTING B-64164EN/01 - 74 - 1.1 PARAMETERS FOR FL-net FUNCTION The parameters for the FL-net function are divided into six major groups: (1) Basic parameters (2) State monitoring parameters (3) Area 1 allocation parameters (4) Area 2 allocation parameters (5) Message allocation parameters (6) Bit parameters Each parameter is detailed below. (1) Basic parameters These parameters are defined by the FL-net communication standards and must be set for every FL-net device of any manufacturer. Table 1-1 Basic Parameters Parameter name Description Parameter number IP address IP address of the local node (The host address section (the last numeric value) of this IP address is the node number of the local node.) Pa10 Address of area 1 Start address of a common memory area 1 area allocated as DO of the local node Pa11 Area 1 size Data size of a common memory area 1 area allocated as DO of the local node Pa12 Address of area 2 Start address of a common memory area 2 area allocated as DO of the local node Pa13 Area 2 size Data size of a common memory area 2 area allocated as DO of the local node Pa14 Token monitoring time Token hold time of the local node Pa15 Allowable minimum frame interval Inter-frame time interval requested to another node Pa16 Node name Equipment name of the local node Pa17'], '1 SETTING OF FL-net FUNCTION': ['B-64164EN/01 SETTING 1.SETTING OF FL-net FUNCTION - 73 - 1 SETTING OF FL-net FUNCTION This part describes how to set the FL-net function CAUTION After setting DI/DO data, make sure communication is performed correctly in a state in which security is retained. Operating the system without confirmation may cause a serious failure.', '1.SETTING OF FL-net FUNCTION SETTING B-64164EN/01 - 74 - 1.1 PARAMETERS FOR FL-net FUNCTION The parameters for the FL-net function are divided into six major groups: (1) Basic parameters (2) State monitoring parameters (3) Area 1 allocation parameters (4) Area 2 allocation parameters (5) Message allocation parameters (6) Bit parameters Each parameter is detailed below. (1) Basic parameters These parameters are defined by the FL-net communication standards and must be set for every FL-net device of any manufacturer. Table 1-1 Basic Parameters Parameter name Description Parameter number IP address IP address of the local node (The host address section (the last numeric value) of this IP address is the node number of the local node.) Pa10 Address of area 1 Start address of a common memory area 1 area allocated as DO of the local node Pa11 Area 1 size Data size of a common memory area 1 area allocated as DO of the local node Pa12 Address of area 2 Start address of a common memory area 2 area allocated as DO of the local node Pa13 Area 2 size Data size of a common memory area 2 area allocated as DO of the local node Pa14 Token monitoring time Token hold time of the local node Pa15 Allowable minimum frame interval Inter-frame time interval requested to another node Pa16 Node name Equipment name of the local node Pa17'], '1.1 PARAMETERS FOR FL-net FUNCTION': ['1.SETTING OF FL-net FUNCTION SETTING B-64164EN/01 - 74 - 1.1 PARAMETERS FOR FL-net FUNCTION The parameters for the FL-net function are divided into six major groups: (1) Basic parameters (2) State monitoring parameters (3) Area 1 allocation parameters (4) Area 2 allocation parameters (5) Message allocation parameters (6) Bit parameters Each parameter is detailed below. (1) Basic parameters These parameters are defined by the FL-net communication standards and must be set for every FL-net device of any manufacturer. Table 1-1 Basic Parameters Parameter name Description Parameter number IP address IP address of the local node (The host address section (the last numeric value) of this IP address is the node number of the local node.) Pa10 Address of area 1 Start address of a common memory area 1 area allocated as DO of the local node Pa11 Area 1 size Data size of a common memory area 1 area allocated as DO of the local node Pa12 Address of area 2 Start address of a common memory area 2 area allocated as DO of the local node Pa13 Area 2 size Data size of a common memory area 2 area allocated as DO of the local node Pa14 Token monitoring time Token hold time of the local node Pa15 Allowable minimum frame interval Inter-frame time interval requested to another node Pa16 Node name Equipment name of the local node Pa17', 'B-64164EN/01 SETTING 1.SETTING OF FL-net FUNCTION - 75 - (2) State monitoring parameters These parameters are used to assign local node status data and remote node status data to the PMC area so that the user program can monitor the statuses of the local node and remote nodes. Table 1-2 State Monitoring Parameters Parameter name Description Parameter number Local node status Start addr ess of an area in the PMC E/R area used as the output destinati on of status information about the local node Pa20 List of participating nodes Start address of an area in the PMC E/R area used as the output destination of a list of all nodes participating in the network Pa21 (3) Area 1 allocation parameters These parameters are used to specify addresses to perform data exchange between common memory area 1 and the PMC area. Table 1-3 Area 1 Allocation Parameters Parameter name Description Parameter number PMC start address (shared by DI/DO) Start address of an area in the PMC E/R area allocated to common memory area 1 Pa30 Area 1 start address(shared by DI/DO) Start address of common memory area 1 allocated to an area in the PMC E/R area Pa31 Allocation size (shared by DI/DO) Size of data to be exchanged Pa32 (4) Area 2 allocation parameters These parameters are used to specify addresses to perform data exchange between common memory area 2 and the PMC area. Since common memory area 2 is larger than the PMC area, allocating separate DI and DO areas is permitted as well as allocating DI and DO at a time in the same way as for common memory area 1. Table 1-4 Area 2 Allocation Parameters (Shared by DI and DO) Parameter name Description Parameter number PMC start address (shared by DI/DO) Start address of an area in the PMC E/R/D area allocated to common memory area 2 Pa47 Area 2 start address(shared by DI/DO) Start address of common memory area 2 allocated to an area in the PMC E/R/D area Pa48 Allocation size (shared by DI/DO) Size of data to be exchanged Pa49', '1.SETTING OF FL-net FUNCTION SETTING B-64164EN/01 - 76 - Table 1-5 Area 2 Allocation Parameters (Separate Allocation for Each of DI and DO) Parameter name Description Parameter number PMC start address (for DO) Start address of a common memory area in the PMC E area, R area, or D area that serves as the source of data to be written to area 2 Pa40 Allocation size (for DO) Size of data written to common memory area 2 Pa41 PMC start address (for DI) Start address of a common memory area in the PMC R area or D area that serves as the read destination of information about other nodes and data from area 2 Pa42 Allocation condition setting (for DI/DO) Address of a common memory area in the PMC D area that is used to specify conditions on data exchange with area 2 Pa43 Condition switch flag(for DI/DO) Flag for switching between specified conditions at the area 2 data exchange condition allocation address above Pa44 Area 2 start address(for DI) Start address of static common memory area 2 to be allocated in the PMC area Pa45 Allocation size (for DI) Size of data statically exchanged Pa46 (5) Message allocation parameters These parameters are used to specify interface areas for making service requests for message transmission and passing a received message to the user program. Table 1-6 Message Allocation Parameters Parameter name Description Parameter number Client function interface Start address of the PMC E, R, or D area that serves as the interface used by the message transmission client function Pa50 Interface size Maximum allowable size of the interface area used above Pa51 Server function interface Start address of the PMC E, R, or D area that serves as the interface used by the message transmission server function Pa52 Interface size Maximum allowable size of the interface area used above Pa53', 'B-64164EN/01 SETTING 1.SETTING OF FL-net FUNCTION - 77 - (6) Bit parameters Table 1-7 Bit parameters Parameter name Description Parameter number Parameter 1 Parameter for FL-net data transfer Pa60 Parameter 2 Parameter for FL-net operation Pa61', '1.SETTING OF FL-net FUNCTION SETTING B-64164EN/01 - 78 - Displaying the parameter screen Procedure 1 Press function key SYSTEM . 2 The [FL-net] soft key appears. (If the [FL-net] soft key is not displayed, press the next-menu key several times, which is located at the right end of soft keys.) 3 Pressing the [FL-net] soft key displays the FL-net PARAMETER screen, the FL-net NODE MONITOR screen, the FL-net NETWORK screen, or the FL-net LOG screen. 4 Press the [PARAMETER] soft key to display the parameter screen (Screen 1-1). 5 You can change pages of the parameter screen by using page keys PAGEPAGE . 6 Move the cursor to the item you want to set, and enter a parameter value.', 'B-64164EN/01 SETTING 1.SETTING OF FL-net FUNCTION - 79 - Screen 1-1 FL-net PARAMETER Screen 7 As necessary, press the [(OPRT)] so ft key, then use the following soft key: 8 If you set bit 2 (DTL) of Pa61 (parameter 2) to 1, the screen for DI/DO allocation of common memory area 2 on the fourth page is displayed as follows (Screen 1-2), allowing you to set the DI area and DO area separately: Screen 1-2 FL-net PARAMETER Screen (Setting of Details) Display item The following display item is explained: Table 1-8 MAC Address Item Description MAC ADDRESS MAC address set for the local FL-net board', '1.SETTING OF FL-net FUNCTION SETTING B-64164EN/01 - 80 - Setting item Each setting item is described below. Basic parameters Parameters for the FL-net function are set. Table 1-9 Basic Parameters Item Description IP ADDRESS Pa10IP address of the local node. The host address section (last numeric value) of this IP address is the node num ber of the local node. Only an IP address in class C can be specified. NODE NAME Pa17An arbitrary node name not longer than 10 characters can be specified. AREA1 ADDRESS (Note 1) Pa11Start address of common memory area 1 of the local node. A value from 0 to 511 can be set. AREA1 SIZE (Note 1) Pa12Data size of common memory area 1 of the local node. A value from 0 to 512 can be set. AREA2 ADDRESS (Note 1) Pa13Start address of common memory area 2 of the local node. A value from 0 to 8191 can be set. AREA2 SIZE (Note 1) Pa14Data size of common memory area 2 of the local node. A value from 0 to 8192 can be set. TOKEN WATCHDOG TIME (Note 2) Pa15Token monitoring time. Maximum duration of time for which the local node can hold the token. A value from 1 to 255 can be set. (Unit: 1msec) MINIMUM FRAME Pa16Minimum allowable frame time interval. Set an inter-frame time inte rval so that the local node can receive data frames in succession. A value from 0 to 50 can be specified. (Unit: 100 µsec) NOTE 1 When the area set for common memory area 1 or 2 overlaps with an area of an other node, the node that participated in the network later must participate in the network with the start addresses and sizes of common memory areas 1 and 2 set to 0. This means that the node participates in the network without its output area. 2 A token monitoring time is set to reissue a token. If the local node does not issue a token when the time specified in this parameter has elapsed, the next node reissues a token. This means that an adequate value needs to be set in connection with the amount of transmit data of the local node. Usually, set 30 (30 msec).', 'B-64164EN/01 SETTING 1.SETTING OF FL-net FUNCTION - 81 - State monitoring parameters The state monitoring parameters are used to allocate areas in the PMC area to which the states of the local node and other nodes are posted. Table 1-10 Area 1 Allocation Parameters Item Description OWN STATUS Pa20Specify the start address of an area in the PMC E/R area to which the communica tion state of the local node is posted. An 8-byte area starting at the start address is used as the local node status area. ENTRY NODE Pa21Specify the start address of an area in the PMC E/R area to which the network par ticipation state of other nodes is posted. A 32-byte area starting at the start address is used as the participating node list area. CAUTION 1 The E area in the PMC area is normally allocated to volatile memory. It, however, can also be used optionally as nonvolatile memory. When the area is set as nonvolatile memory, the contents of the area are retained even after the power is turned off. So, special attention should be paid not to cause an unpredictable operation when the power is turned on next time. 2 When setting the PMC area, note the following: The R address or E address can be set. For a multi-path PMC, enter an PMC address as follows: <Path number>:<PMC address> For R0500 for the second PMC path, for example, enter "2:R500". When only a PMC address (R500) is entered, it is assumed to be the PMC address for the first path (1:R0500). If the ":" key is not provided, the "/" or "EOB" key can be used instead. 3 Be careful not to cause an overlap between an area such as the input data area of the user program and a PMC area used for other purposes. NOTE 1 When the above area is not used, enter a space. "---" appears, indicating that the area is not used. 2 Only a PMC area at an even-numbered address can be set for the above area.', '1.SETTING OF FL-net FUNCTION SETTING B-64164EN/01 - 82 - Bit parameters The bit parameters are used to specify data conversion at the time of FL-net data transfer and to make other settings. Table 1-11 Bit Parameters Item Description Parameter 1 Pa60Bit parameters for FL-net data transfer. Bit 0: CYC Byte swapping of cyclic data in common memory areas 1 and 2 is: 0: Not performed. 1: Performed. Bit 1: WRD Byte swapping of word block data and transparent message data is: 0: Not performed. 1: Performed. Bit 2: BYT Byte swapping of byte block data is: 0: Not performed. 1: Performed. Bits 7-3: RSV Be sure to set 0. Parameter 2 Pa61Bit parameters for FL-net operation Bit 0: BAK Be sure to set 0. Bit 1: AUT Be sure to set 0. Bit 2: DTL By using specifications compatible with the old model, common memory area 2 allocation parameters are: 0: Not set. 1: Set. Bits 7-3: RSV Be sure to set 0. Area 1 allocation parameters The area 1 allocation parameters are used for allocation-related settings to enable data exchange between common memory area 1 and the PMC E/R area. Table 1-12 Area 1 Allocation Parameters Item Description PMC ADDRESS (Note 1) Pa30Specify the start address of an area in the PMC E area or the PMC R area used for data exchange with common memory area 1. AREAR1 ADDRESS Pa31Specify the start addre ss of an area in common memory area 1 used for data exchange with the PMC E area or the PMC R area. ALLOCATED SIZE(WORD) (Note 2) Pa32Specify the size of data exchanged between common memory area 1 and the PMC E area or the PMC R area (Unit: Words). When data exchange between common memory area 1 and the PMC is not performed, set 0 in this parameter.', 'B-64164EN/01 SETTING 1.SETTING OF FL-net FUNCTION - 83 - CAUTION 1 The E area in the PMC area is normally allocated to volatile memory. It, however, can also be used optionally as nonvolatile memory. When the area is set as nonvolatile memory, the contents of the area are retained even after the power is turned off. So, special attention should be paid not to cause an unpredictable operation when the power is turned on next time. 2 When setting the PMC area, note the following: The R address or E address can be set. For a multi-path PMC, enter an PMC address as follows: <Path number>:<PMC address> For R0500 for the second PMC path, for example, enter "2:R500". When only a PMC address (R500) is entered, it is assumed to be the PMC address for the first path (1:R0500). If the ":" key is not provided, the "/" or "EOB" key can be used instead. 3 Be careful not to cause an overlap between an area such as the input data area of the user program and a PMC area used for other purposes. NOTE 1 Only a PMC area at an even-numbered address can be set for the above area. 2 The unit of size set in this parameter is words. This means that for an area used in the PMC E area or the PMC R area, the number of bytes as many as the size set in this parameter multiplied by 2 is required.', '1.SETTING OF FL-net FUNCTION SETTING B-64164EN/01 - 84 - Area 2 allocation parameters The area 2 allocation parameters are used for allocation-related settings to enable data exchange between common memory area 2 and the PMC E area, the PMC R area, or the PMC D area. Table 1-13 Area 2 Allocation Parameters (Shared by DI and DO) Item Description PMC ADDRESS (Note 1) Pa47Specify the start address of an area in the PMC E area, the PMC R area or the PMC D area used for data exchange with common memory area 2. AREAR2 ADDRESS Pa48Specify the start addre ss of an area in common memory area 2 used for data exchange with the PMC E area, the PMC R ar ea or the PMC D area. ALLOCATED SIZE(WORD) (Note 2) Pa49Specify the size of data exchanged between common memory area 2 and the PMC E area, the PMC R area or the PMC D area (Unit: Words). When data exchange between common memory area 2 and the PMC is not performed, set 0 in this parameter. CAUTION 1 When nonvolatile memory in the PMC area is used, the memory contents are retained even after the power is turned off. So, special attention should be paid not to cause an unpredictable operation when the power is turned on next time. 2 When setting the PMC ar ea, note the following: The R address, E address, or D address can be set. For a multi-path PMC, enter an PMC address as follows: <Path number>:<PMC address> For R0500 for the second PMC path, for example, enter "2:R500". When only a PMC address (R500) is entered, it is assumed to be the PMC address for the first path (1:R0500). If the ":" key is not provided, the "/" or "EOB" key can be used instead. 3 Be careful not to cause an overlap between an area such as the input data area of the user program and a PMC area used for other purposes.', 'B-64164EN/01 SETTING 1.SETTING OF FL-net FUNCTION - 85 - NOTE 1 Only a PMC area at an even-numbered address can be set for the above area. 2 The unit of size set in this parameter is words. This means that for an area used in the PMC E area, the PMC R area or the PMC D area, the number of bytes as many as the size set in this parameter multiplied by 2 is required. 3 As with the old model, DI and DO for common memory area 2 can also be allocated to the PMC area separately. When making such settings, see Subsection 2.2.2, "Separate Allocation of DI and DO Areas" in "II. SPECIFICATION". Table 1-14 Area 2 Allocation Parameters （Separate Allocation of DI and DO ） Item Description AREA2 DO PMC ADDRESS (Note 1) Pa40Specify the start address of an area in the PMC E area, the PMC R area, or the PMC D area used for DO data exchange with common memory area 2. This parameter allows only an even address to be set. AREA2 DO ALLOCATED SIZE(WORD) (Note 1) Pa41Specify the size of DO data exchanged between common memory area 2 and the PMC E area, the PMC R area, or the PMC D area (Unit: Words). When DO data exchange between common memory area 2 and the PMC is not performed, set 0 in this parameter. AREA2 DI PMC ADDRESS Pa42Specify the start address of an area in the PMC E area, the PMC R area, or the PMC D area used for DI data exchange with common memory area 2. When DI data exchange is not performed between common memory area 2 and PM C, specify a space. "---" appears, indicating that this area is not used. This parameter allows only an even address to be set. AREA2 DI ALLOC PTR (Note 2) Pa43Set the PMC D area for setting DI/DO data allocation conditions. When DI/DO data allocation conditions are not set, specify a space. "---" appear s, indicating that this area is not used. This parameter allows only an even address to be set. AREA2 DI CHANGE FLAG (Note 2) Pa44Specify the PMC E or R area for indicating the time when the above allocation conditions are changed. When the allocation conditions are not changed dynamically, specify a space. "---" appears, indicating that this area is not used. AREA2 DI AREA2 ADDRESS (Note 2) Pa45Specify the start address of common memory area 2 to be statically allocated in the PMC area as DI data AREA2 DI ALLOCATED SIZE(WORD) (Notes 1, 2) Pa46Specify the size of DI data statically exchanged between common memory area 2 and the PMC area (Unit: Words)', '1.SETTING OF FL-net FUNCTION SETTING B-64164EN/01 - 86 - CAUTION 1 When nonvolatile memory in the PMC area is used, the memory contents are retained even after the power is turned off. So, special attention should be paid not to cause an unpredictable operation when the power is turned on next time. 2 When setting the PMC ar ea, note the following: The R address, E address, or D address can be set. For a multi-path PMC, enter an PMC address as follows: <Path number>:<PMC address> For R0500 for the second PMC path, for example, enter "2:R500". When only a PMC address (R500) is entered, it is assumed to be the PMC address for the first path (1:R0500). If the ":" key is not provided, the "/" or "EOB" key can be used instead. 3 Be careful not to cause an overlap between an area such as the input data area of the user program and a PMC area used for other purposes. NOTE 1 In these parameters, set a size in words. Therefore, the area size s used in the PMC area require twice as many bytes as the values set in these parameters. 2 By using parameters P a45 (area 2 start address) and Pa46 (allocation size), a large area can be set between common memory 2 and the PMC area regardless of the node number. When Pa46 (allocation size) is set to 0, dynamic DI data switching is performed for each node without static allocation. When Pa46 (allocation size) is set to a value other than 0, data in common memory area 2 starting at the start address set by Pa45 (area 2 start address) is transferred to the PMC area specified by (Pa42 (PMC start address) plus 4), and dynamic DI data switching is disabled. In this case, Pa43 (allocation condition setting) and Pa44 (condition switch flag) are used only for switching node status information.', 'B-64164EN/01 SETTING 1.SETTING OF FL-net FUNCTION - 87 - Message allocation parameters The message allocation parameters are used to allocate a message transmit interface area in the PMC E area, the PMC R area, or the PMC D area. Table 1-15 Message Allocation Parameters Item Description CLIENT I/F (Note) Pa50Specify the start address of an interface area in the PMC E area, the PMC R area, or the PMC D area used when the message transmission c lient function is used. I/F SIZE(BYTE) Pa51Specify the size of the inte rface area above (Unit: Bytes). When the message transmission client function is not used, set 0 in this parameter. SERVER I/F (Note) Pa52Specify the start address of the PMC E, R, or D area used as the interfac e area when the message transmission server function is used. I/F SIZE(BYTE) Pa53Specify the size of the inte rface area above (Unit: Bytes). When the message transmission client function is not used, set 0 in this parameter. CAUTION 1 When nonvolatile memory in the PMC area is used, the memory contents are retained even after the power is turned off. So, special attention should be paid not to cause an unpredictable operation when the power is turned on next time. 2 When setting the PMC ar ea, note the following: The R address, E address, or D address can be set. For a multi-path PMC, enter an PMC address as follows: <Path number>:<PMC address> For R0500 for the second PMC path, for example, enter "2:R500". When only a PMC address (R500) is entered, it is assumed to be the PMC address for the first path (1:R0500). If the ":" key is not provided, the "/" or "EOB" key can be used instead. 3 Be careful not to cause an overlap between an area such as the input data area of the user program and a PMC area used for other purposes. NOTE Only a PMC area at an even-numbered address can be set for the above area.', '1.SETTING OF FL-net FUNCTION SETTING B-64164EN/01 - 88 - 1.2 MAINTENANCE SCREENS OF FL-net FUNCTION The FL-net maintenance screens include the FL-net NODE MONITOR screen, the FL-net NETWORK screen, and the FL-net LOG screen. The FL-net NODE MONITOR screen provides information such as nodes participating in the networ k and parameters of each node. The FL-net NETWORK screen provides network information such as the communication cycle of the network. The FL-net LOG screen provides information such as the number of times an error has occurred on the network. Procedure 1 Press function key SYSTEM . 2 The [FL-net] soft key appears. (If the [FL-net] soft key is not displayed, press the next-menu key several times, which is located at the right end of soft keys.) 3 Pressing the [FL-net] soft key displays the FL-net PARAMETER screen, the FL-net NODE MONITOR screen, the FL-net NETWORK screen, or the FL-net LOG screen. 4 Press the [NODE], [NETWORK], or [LOG] to display a desired screen.'], '1.2 MAINTENANCE SCREENS OF FL-net FUNCTION': ['1.SETTING OF FL-net FUNCTION SETTING B-64164EN/01 - 88 - 1.2 MAINTENANCE SCREENS OF FL-net FUNCTION The FL-net maintenance screens include the FL-net NODE MONITOR screen, the FL-net NETWORK screen, and the FL-net LOG screen. The FL-net NODE MONITOR screen provides information such as nodes participating in the networ k and parameters of each node. The FL-net NETWORK screen provides network information such as the communication cycle of the network. The FL-net LOG screen provides information such as the number of times an error has occurred on the network. Procedure 1 Press function key SYSTEM . 2 The [FL-net] soft key appears. (If the [FL-net] soft key is not displayed, press the next-menu key several times, which is located at the right end of soft keys.) 3 Pressing the [FL-net] soft key displays the FL-net PARAMETER screen, the FL-net NODE MONITOR screen, the FL-net NETWORK screen, or the FL-net LOG screen. 4 Press the [NODE], [NETWORK], or [LOG] to display a desired screen.', 'B-64164EN/01 SETTING 1.SETTING OF FL-net FUNCTION - 89 - 1.2.1 Participating-Node Management Table Nodes participating in the FL-net network, parameters of each node, and other information are displayed on this screen. Procedure 1 Press the [NODE] soft key. The NODE MONITOR screen (Screen 1-3 FL-net Node Monitor Screen) then appears. 2 You can change pages of the NODE MONITOR screen by using page keys PAGEPAGE . Screen 1-3 FL-net Node Monitor Screen 3 As you move the cursor to a node number, information on the node with the node number is displayed.'], '1.2.1 Participating-Node Management Table': ['B-64164EN/01 SETTING 1.SETTING OF FL-net FUNCTION - 89 - 1.2.1 Participating-Node Management Table Nodes participating in the FL-net network, parameters of each node, and other information are displayed on this screen. Procedure 1 Press the [NODE] soft key. The NODE MONITOR screen (Screen 1-3 FL-net Node Monitor Screen) then appears. 2 You can change pages of the NODE MONITOR screen by using page keys PAGEPAGE . Screen 1-3 FL-net Node Monitor Screen 3 As you move the cursor to a node number, information on the node with the node number is displayed.', '1.SETTING OF FL-net FUNCTION SETTING B-64164EN/01 - 90 - 4 As necessary, press the [(OPRT)] so ft key, then use the following soft keys: SELECT NODE When you enter a node number by using the MDI keys then press the [SELECT NODE] soft key, information about the entered node number is displayed. PREV NODE NEXT NODE When you press the [PREV NODE] or [NEXT NODE] soft key, you can change the node number to the node number preceding or following the node on which the cursor is currently positioned.. DETAIL When you press the [DETAIL] soft key, detailed information on the node with the node number on whic h the cursor is positioned is displayed (Screen 1-4). Screen 1-4 FL-net NODE MONITOR Screen (Details) LIST When you press the [LIST] soft key, the screen display returns to the original list screen （Screen 1-3 FL-net Node Monitor Screen ）.', 'B-64164EN/01 SETTING 1.SETTING OF FL-net FUNCTION - 91 - Display item Item Description Node status list A list of the st atuses of nodes is displayed. *: Local node O: Node participating in the network -: Node not participating in the network NODE NUMBER Indicates a node number. A number from 1 to 254 is displayed. OWN STATUS When the node on which t he cursor is positioned is the local node, the status of t he local node is indicated in hexadecimal notation. When the node is not the local node, "--H" is displayed. Bit 7: Reserved. Bit 6: Node number duplicate flag This bit is set to 1 when a node having the same node number as the local node is detected on the network. Correct the setting so that the local node has a unique node number among the node numbers of other nodes on the network. Bit 5: Reception wait flag This bit is set to 1 when there is no other node on the network. Bit 4: Initialization error flag This bit is set to 1 when an error is detected during parameter initialization. Correct the parameter settings. Bit 3: Token monitoring time error flag This bit is set to 1 when data cannot be transmitted within a half of the token monitoring time set in parameter Pa15. Increase the setting of the token monitoring time (Pa15). Bits 2-0: Reserved. ULS The upper layer status of a node on which the cursor is positioned is indicated in hexadecimal notation. Bit 15: RUN/STOP Whether the ladder program for the first PMC path is running (1) or stopped (0) can be checked. Bits 14,13: U_ERR These bits are not used at present. Bit 12: Unused. Bits 11-0: U_ERR_CODE These bits are not used at present.', "1.SETTING OF FL-net FUNCTION SETTING B-64164EN/01 - 92 - Item Description LKS The FA link layer status of a node on which the cursor is positioned is indicated in hexadecimal notation. Bit 7: Duplicate address detection flag This bit is set to 1 when a setting for common memory area 1 or 2 is the same as a setting in another node. Check and correct the parameter settings. Bit 6: Common memory setting completion flag This bit is set to 1 when the setting of common memory is completed. This means that this bit is set to 1 when the parameters related to common memory (Pa11, Pa12, Pa13, and Pa14) are correct. Bit 5: Common memory data validity notification flag This bit is set to 1 when cyclic data in common memory is normally exchanged with the PMC area. Bit 4: Upper-layer operation signal error flag This bit is not used at present. Bits 3,2: Unused Bit 1: Communication disable detection flag This bit is set to 1 when a device in a different token mode is detected (Note1). Bit 0: Node participation/disconnection This bit is set to 1 when the node is participating in the network. AREA1 ADDRESS Indicates the start address of common memory area 1 of a node on which the cu rsor is positioned. AREA1 SIZE Indicates the size of common memory area 1 of a node on which the cursor is positioned. AREA2 ADDRESS Indicates the start address of common memory area 2 of a node on which the cu rsor is positioned. AREA2 SIZE Indicates the size of common memory area 2 of a node on which the cursor is positioned. TOKEN WATCHDOG TIME Indicates the token monitoring time of a node on which the cursor is positioned. (Unit: 1 ms) MINIMUM FRAME TIME Indicates the minimum allowable frame interval of a node on which the cursor is positioned. (Unit: 100 µs) NODE Indicates the node name of a node on which the cursor is positioned. (Note 2) VENDOR Indicates the vendor name of a node on which the cursor is positioned. (Note 2) MAKER Indicates the manufactu rer's model number of a node on which the cursor is positioned. (Note 2) REFRESH CYCLE TIME Indicates the permissible refresh cycle time of a node on which the cursor is positioned.", 'B-64164EN/01 SETTING 1.SETTING OF FL-net FUNCTION - 93 - NOTE 1 The token mode varies depending on whether the version of the FL-net communication standards is version 1.00 or version 2.00. If the communication disable detection flag is set, ensure that all nodes comply with FL-net communication standards version 2.00. FANUC FL-net devices comply with FL-net communication standards version 2.00. 2 These information items are indicated when the node pointed to by the cursor participates in the network at the same time or at a later time.', '1.SETTING OF FL-net FUNCTION SETTING B-64164EN/01 - 94 - 1.2.2 Network Management Table The FL-net network management table screen allows the user to reference the parameters of each node in the FL-net network management table. Procedure 1 Press the [NETWORK] soft key. The NETWORK screen (Screen 1-5) then appears. Screen 1-5 FL-net NETWORK Screen 2 As necessary, press the [(OPRT)] so ft key, then use the following soft keys: Display item Item Description TOKEN NODE Indicates the node num ber of a node having a token. MINIMUM FRAME TIME Indicates the maximum value among the minimum allowable frame intervals of the nodes participating in the network. (Unit: 100 µs) REFRESH CYCLE TIME Indicates the current allowable refresh cycle time measured for the local node. (Unit: 1 ms) This value is 120% of the refresh cycle measurement time. REFRESH CYCLE MEASURE Indicates the current refresh cy cle measurement time measured for the local node. (Unit: 1 ms) REFRESH CYCLE MEASURE(MAX) Indicates the maximum value among the refresh cycle measurement times measured for the local node. (Unit: 1 ms) REFRESH CYCLE MEASURE(MIN) Indicates the minimum value among the refresh cycle measurement times measured for the local node. (Unit: 1 ms) CLEAR Pressing the [CLEAR] soft key resets the maximum value and minimum value of refresh cycle measurement times.'], '1.2.2 Network Management Table': ['1.SETTING OF FL-net FUNCTION SETTING B-64164EN/01 - 94 - 1.2.2 Network Management Table The FL-net network management table screen allows the user to reference the parameters of each node in the FL-net network management table. Procedure 1 Press the [NETWORK] soft key. The NETWORK screen (Screen 1-5) then appears. Screen 1-5 FL-net NETWORK Screen 2 As necessary, press the [(OPRT)] so ft key, then use the following soft keys: Display item Item Description TOKEN NODE Indicates the node num ber of a node having a token. MINIMUM FRAME TIME Indicates the maximum value among the minimum allowable frame intervals of the nodes participating in the network. (Unit: 100 µs) REFRESH CYCLE TIME Indicates the current allowable refresh cycle time measured for the local node. (Unit: 1 ms) This value is 120% of the refresh cycle measurement time. REFRESH CYCLE MEASURE Indicates the current refresh cy cle measurement time measured for the local node. (Unit: 1 ms) REFRESH CYCLE MEASURE(MAX) Indicates the maximum value among the refresh cycle measurement times measured for the local node. (Unit: 1 ms) REFRESH CYCLE MEASURE(MIN) Indicates the minimum value among the refresh cycle measurement times measured for the local node. (Unit: 1 ms) CLEAR Pressing the [CLEAR] soft key resets the maximum value and minimum value of refresh cycle measurement times.', 'B-64164EN/01 SETTING 1.SETTING OF FL-net FUNCTION - 95 - 1.2.3 Log Information Management Table This screen provides network log information of the local node. Procedure 1 Press the [LOG] soft key. The LOG screen (Screen 1-6 FL-net Log Screen) then appears. Screen 1-6 FL-net Log Screen 2 As necessary, press the [(OPRT)] so ft key, then use the following soft key: Display item Item Description TOTAL SEND Indicates the number of transmitted frames. SEND ERROR Indicates the number of times a transmission error occurred. TOTAL RECEIVE Indicates the number of received frames. RECEIVE ERROR Indicates the number of times a reception error occurred. The reception of a frame not complying with the FL-net communication standards is al so counted as a reception error. CYCLE DATA ERROR Indicates the number of times an error occurred during cyclic data transmission. ACK ERROR Indicates the number of times an ACK error occurred during message transmission. MESSAGE RETRY Indicates the number of time s a message was retransmitted. MESSAGE RETRY OVER Indicates the number of times the message retransmission limit was exceeded. A message is retransmitted up to three times in one message transmission operation. A failure in normal message transmission after three retransmissions is counted. MESSAGE RECEIVE ERRORIndicates the number of times a reception error occurred during message transmission.'], '1.2.3 Log Information Management Table': ['B-64164EN/01 SETTING 1.SETTING OF FL-net FUNCTION - 95 - 1.2.3 Log Information Management Table This screen provides network log information of the local node. Procedure 1 Press the [LOG] soft key. The LOG screen (Screen 1-6 FL-net Log Screen) then appears. Screen 1-6 FL-net Log Screen 2 As necessary, press the [(OPRT)] so ft key, then use the following soft key: Display item Item Description TOTAL SEND Indicates the number of transmitted frames. SEND ERROR Indicates the number of times a transmission error occurred. TOTAL RECEIVE Indicates the number of received frames. RECEIVE ERROR Indicates the number of times a reception error occurred. The reception of a frame not complying with the FL-net communication standards is al so counted as a reception error. CYCLE DATA ERROR Indicates the number of times an error occurred during cyclic data transmission. ACK ERROR Indicates the number of times an ACK error occurred during message transmission. MESSAGE RETRY Indicates the number of time s a message was retransmitted. MESSAGE RETRY OVER Indicates the number of times the message retransmission limit was exceeded. A message is retransmitted up to three times in one message transmission operation. A failure in normal message transmission after three retransmissions is counted. MESSAGE RECEIVE ERRORIndicates the number of times a reception error occurred during message transmission.', '1.SETTING OF FL-net FUNCTION SETTING B-64164EN/01 - 96 - Item Description DUPLICATED TOKEN Indicates the number of times a duplicate token was detected. DESTROYED TOKEN Indicates the number of times a token was discarded when its duplication was detected, REISSUE TOKEN Indicates the number of times a token was reissued because no token was transmitted from the node preceding the local node. WAIT FRAME Indicates the number of times the frame wait state was entered because there was no other node on the network. ENTRY NETWORK Indicates the number of time s the local node participated in the network. HOLDING TOKEN TIMEOUT Indicates the number of times a token hold timeout was detected. SKIP DISCONNECT Indicates the number of times the local node was disconnected from the network because no token was passed to the local node after its participation in the network. OTHER NODE DISCONNECT Indicates the number of time s other nodes were disconnected from the network. CLEAR Pressing the [CLEAR] soft key clears all communication log data to 0 so that counting starts from the beginning.', 'B-64164EN/01 SETTING 1.SETTING OF FL-net FUNCTION - 97 - 1.3 NOTES ON LADDER PROGRAM CREATION This section provides necessary notes on ladder program creation to build a safety system that uses the FL-net. Input and output signals An output signal from the CNC is processed by a ladder program, and written in a register. It is then read by refresh processing of the FL-net function, and is sent out on the FL-net network. When a node receives data, the node outputs the data as an output signal. Input signals flow through a similar path in the reverse direction. Fig. 1-1 Input and Output Signals ラダープログラム 処理 PMC レジスタ （メモリ） DeviceNet マスタ機能 リフレッシュ 処理 スレーブ スレーブ Communication processing Input signalOutput signalＣＮＣ スレーブ ・・・・・ Ladder program PMC Register (memory) FL-net functionRefresh processing FL-net device FL-net device ＣＮＣ FL-net device ・・・・・'], '1.3 NOTES ON LADDER PROGRAM CREATION': ['B-64164EN/01 SETTING 1.SETTING OF FL-net FUNCTION - 97 - 1.3 NOTES ON LADDER PROGRAM CREATION This section provides necessary notes on ladder program creation to build a safety system that uses the FL-net. Input and output signals An output signal from the CNC is processed by a ladder program, and written in a register. It is then read by refresh processing of the FL-net function, and is sent out on the FL-net network. When a node receives data, the node outputs the data as an output signal. Input signals flow through a similar path in the reverse direction. Fig. 1-1 Input and Output Signals ラダープログラム 処理 PMC レジスタ （メモリ） DeviceNet マスタ機能 リフレッシュ 処理 スレーブ スレーブ Communication processing Input signalOutput signalＣＮＣ スレーブ ・・・・・ Ladder program PMC Register (memory) FL-net functionRefresh processing FL-net device FL-net device ＣＮＣ FL-net device ・・・・・', '1.SETTING OF FL-net FUNCTION SETTING B-64164EN/01 - 98 - Ladder program processing and refresh processing of FL-net function Ladder program processing and refresh processing of the FL-net function operate asynchronously. Because ladder program processing can be performed independently of refresh processing of the FL-net function, the ladder program can run repeatedly at high speed. Fig. 1-2 is a timing diagram of the inside of the CNC when a ladder program outputs signals. Fig. 1-2 Timing Diagram In the upper part of the diagram, the ladder program performs processing cyclically and writes data in registers A and B. In the middle part, how the contents of registers A and B in the PMC are updated at this time. Even within one-time execution of the ladder program, data is not written to register A and register B at the same time. Therefore, register A and register B are not updated at the same time, and there is a time difference in updating register A and updating register B. In the lower part, refresh processing of the FL-net function is performed cyclically to read the contents of register A and register B. Since there is a time difference in updating register A and register B, data written in one ladder progr am operation cannot sometimes be read at a time as shown in the (n+1)th refresh processing. Also when input signals from a slave are processed by the ladder program, register contents writte n by one refresh operation cannot sometimes be read by one ladder program operation. Content of register A: Content of register B: ０ ０ １１ ２ ２ ３ ３ (mth) ((m+1)th) ((m+2)th) (nth)１，１ ２，２ ３，３Ladder program processing: ((n+1)th) ((n+2)th) ((n+3)th)１ １ ２ ２ ３ ３ ２，１ 0 0 11 2 2 3 3 1, 1 2, 2 ３，３1 12 2 3 3 2, 1Refresh processing of FL-net function: Transferred to other nodes', 'B-64164EN/01 SETTING 1.SETTING OF FL-net FUNCTION - 99 - CAUTION Refresh processing of the FL-net function is performed not in synchronization with the execution of the ladder pr ogram. Therefore, when creating a ladder program , note the following: 1 When an FL-net input signal set at a specified PMC address is read at two places in the ladder program, there is no guar antee that the same value will be read even if the ladder program can be executed in one cycle. 2 When the ladder progr am writes an output signal to the FL-net at a specified PMC address, the signal may be transferred to another node before the ladder program execution completes.', '1.SETTING OF FL-net FUNCTION SETTING B-64164EN/01 - 100 - Data concurrency When a ladder program uses DI data or DO data in long data (4-byte data) units and in word data (2 -byte data) units, concurrency of multiple bytes of data (with no da ta split) is guaranteed under the restrictions explained below. CAUTION If the restrictions described in this section are not observed, concurrency of long data and word data cannot be guaranteed. Concurrency of long data (4-byte data) To ensure data concurrency, th e following two conditions must be observed: (1) In the ladder program, the following instructions must be used in units of four bytes: DECB, CODEB, DCNVB, COMPB, DSCHB, XMOVB, ADDB, SUBB, MULB, NUMEB, MOVN, EOR, AND, OR, and NOT instructions (2) When DI data or DO data is assigned to PMC R, E, or D addresses, these addresses must be on 4-byte boundaries. Example) 1:R0000, 2:R0004, 3:R0008, 1:E0000, 2:D0012 Concurrency of word data (2-byte data) To ensure data concurrency, th e following two conditions must be observed: (1) In the ladder program, the following instructions must be used in units of two bytes: DECB, CODEB, DCNVB, COMPB, DSCHB, XMOVB, ADDB, SUBB, MULB, NUMEB, MOVN, EOR, AND, OR, and NOT instructions (2) When DI data or DO data is assigned to PMC R, E, or D addresses, these addresses must be on 2-byte boundaries. Example) 1:R0000, 2:R0002, 3:R0004, 1:E0002, 2:D0006 Concurrency of byte data (1-byte data) There is no special restriction. W ithin 1-byte data, concurrency is always ensured.', 'B-64164EN/01 SETTING 2.EXAMPLE OF CONNECTION - 101 - 2 EXAMPLE OF CONNECTION This chapter describes an example of connection using the FL-net function with the Series 30 i/31 i/32 i-A.'], '2 EXAMPLE OF CONNECTION': ['B-64164EN/01 SETTING 2.EXAMPLE OF CONNECTION - 101 - 2 EXAMPLE OF CONNECTION This chapter describes an example of connection using the FL-net function with the Series 30 i/31 i/32 i-A.', '2.EXAMPLE OF CONNECTION SETTING B-64164EN/01 - 102 - 2.1 EXAMPLE OF CONFIGURATION Using the example of configuration shown below, this section describes the setting of each parameter. Fig. 2-1 Example of FL-net Configuration The parameter settings and PMC area allocation state when 4-word DO data in common memory area 1 and 64-word DO data in common memory area 2 are exchanged at all of the three nodes are described below. The common memory of each node is allocated as shown below. Common memory area 1 Common memory area 2 0Node No. #1 0 Node No. #1 4Node No. #2 8Node No. #3 64 Node No. #2 12 128 Node No. #3 192 511 8191 FL-net Series 30 i-A Series 31 i-A Series 32 i-A Node No. #1 Node No. #2 Node No. #3'], '2.1 EXAMPLE OF CONFIGURATION': ['2.EXAMPLE OF CONNECTION SETTING B-64164EN/01 - 102 - 2.1 EXAMPLE OF CONFIGURATION Using the example of configuration shown below, this section describes the setting of each parameter. Fig. 2-1 Example of FL-net Configuration The parameter settings and PMC area allocation state when 4-word DO data in common memory area 1 and 64-word DO data in common memory area 2 are exchanged at all of the three nodes are described below. The common memory of each node is allocated as shown below. Common memory area 1 Common memory area 2 0Node No. #1 0 Node No. #1 4Node No. #2 8Node No. #3 64 Node No. #2 12 128 Node No. #3 192 511 8191 FL-net Series 30 i-A Series 31 i-A Series 32 i-A Node No. #1 Node No. #2 Node No. #3', 'B-64164EN/01 SETTING 2.EXAMPLE OF CONNECTION - 103 - 2.2 EXAMPLE OF PARAMETER SETTINGS Assume that the address map of the PMC R area of each node is as shown below. Then, the parameters of each node are set as indicated in Table 2-1 through Table 2-3. PMC R area 1:R0000 Local node information 1:R0008 Participating node list 1:R0040 Free space 1:R0100 Node No. #1 1:R0108 Node No. #2 1:R0116Common memory area 1 data Node No. #3 1:R0124 Free space 1:R0200Node No. #1 1:R0328Node No. #2 1:R0456Common memory area 2 data Node No. #3 1:R0584 Free space 1:R0600Interface 1:R0620 Message transmission client Read/write buffer 1:R1644'], '2.2 EXAMPLE OF PARAMETER SETTINGS': ['B-64164EN/01 SETTING 2.EXAMPLE OF CONNECTION - 103 - 2.2 EXAMPLE OF PARAMETER SETTINGS Assume that the address map of the PMC R area of each node is as shown below. Then, the parameters of each node are set as indicated in Table 2-1 through Table 2-3. PMC R area 1:R0000 Local node information 1:R0008 Participating node list 1:R0040 Free space 1:R0100 Node No. #1 1:R0108 Node No. #2 1:R0116Common memory area 1 data Node No. #3 1:R0124 Free space 1:R0200Node No. #1 1:R0328Node No. #2 1:R0456Common memory area 2 data Node No. #3 1:R0584 Free space 1:R0600Interface 1:R0620 Message transmission client Read/write buffer 1:R1644', '2.EXAMPLE OF CONNECTION SETTING B-64164EN/01 - 104 - Table 2-1 Parameters of Node No. #1 Item Setting Item Setting Pa10 IP ADDRESS 192.168.250.1 Area 1 DI/DO allocation - Pa17 NODE NAME FS30i-A Pa30 PMC ADDRESS 1:R0100 Pa11 AREA 1 ADDRESS 0 Pa31 AREA 1 ADDRESS 0 Pa12 AREA 1 SIZE 4 Pa32 ALLOCATED SIZE 12 Pa13 AREA 2 ADDRESS 0 Area 2 DI/DO allocation - Pa14 AREA 2 SIZE 64 Pa47 PMC ADDRESS 1:R0200 Pa15 TOKEN WATCHDOG TIME 30 Pa48 AREA 2 ADDRESS 0 Pa16 MINIMUM FRAME 0 Pa49 ALLOCATED SIZE 192 Pa20 OWN STATUS 1:R0000 Message transmission - Pa21 ENTRY NODE 1:R0008 Pa50 CLIENT I/F 1:R0600 Pa60 PARAMETER 1 00000000 Pa51 I/F SIZE 20 Pa61 PARAMETER 2 00000000 Pa52 SERVER I/F --- Pa53 I/F SIZE 0 Table 2-2 Parameters of Node No. #2 Item Setting Item Setting Pa10 IP ADDRESS 192.168.250.2 Area 1 DI/DO allocation - Pa17 NODE NAME FS31i-A Pa30 PMC ADDRESS 1:R0100 Pa11 AREA 1 ADDRESS 4 Pa31 AREA 1 ADDRESS 0 Pa12 AREA 1 SIZE 4 Pa32 ALLOCATED SIZE 12 Pa13 AREA 2 ADDRESS 64 Area 2 DI/DO allocation - Pa14 AREA 2 SIZE 64 Pa47 PMC ADDRESS 1:R0200 Pa15 TOKEN WATCHDOG TIME 30 Pa48 AREA 2 ADDRESS 0 Pa16 MINIMUM FRAME 0 Pa49 ALLOCATED SIZE 192 Pa20 OWN STATUS 1:R0000 Message transmission - Pa21 ENTRY NODE 1:R0008 Pa50 CLIENT I/F 1:R0600 Pa60 PARAMETER 1 00000000 Pa51 I/F SIZE 20 Pa61 PARAMETER 2 00000000 Pa52 SERVER I/F --- Pa53 I/F SIZE 0 Table 2-3 Parameters of Node No. #3 Item Setting Item Setting Pa10 IP ADDRESS 192.168.250.3 Area 1 DI/DO allocation - Pa17 NODE NAME FS32i-A Pa30 PMC ADDRESS 1:R0100 Pa11 AREA 1 ADDRESS 8 Pa31 AREA 1 ADDRESS 0 Pa12 AREA 1 SIZE 4 Pa32 ALLOCATED SIZE 12 Pa13 AREA 2 ADDRESS 128 Area 2 DI/DO allocation - Pa14 AREA 2 SIZE 64 Pa47 PMC ADDRESS 1:R0200 Pa15 TOKEN WATCHDOG TIME 30 Pa48 AREA 2 ADDRESS 0 Pa16 MINIMUM FRAME 0 Pa49 ALLOCATED SIZE 192 Pa20 OWN STATUS 1:R0000 Message transmission - Pa21 ENTRY NODE 1:R0008 Pa50 CLIENT I/F 1:R0600 Pa60 PARAMETER 1 00000000 Pa51 I/F SIZE 20 Pa61 PARAMETER 2 00000000 Pa52 SERVER I/F --- Pa53 I/F SIZE 0', 'B-64164EN/01 SETTING 2.EXAMPLE OF CONNECTION - 105 - 2.3 IMAGE OF DATA EXCHANGE When data exchange is performed with the examples of configuration and parameter settings described ear lier, the illustration below shows how the data of each node is viewed in the PMC R area of each node. Node No. #1 Node No. #2 Node No. #3 1:R0000 1:R0000 1:R0000 1:R0100 Area 1 #11:R0100 Area 1 #1 1:R0100 Area 1 #1 1:R0108 Area 1 #21:R0108 Area 1 #2 1:R0108 Area 1 #2 1:R0116 Area 1 #31:R0116 Area 1 #3 1:R0116 Area 1 #3 1:R0124 1:R0124 1:R0124 1:R0200 Area 2 #11:R0200 Area 2 #1 1:R0200 Area 2 #1 1:R0328 Area 2 #21:R0328 Area 2 #2 1:R0328 Area 2 #2 1:R0456 Area 2 #31:R0456 Area 2 #3 1:R0456 Area 2 #3 1:R0584 1:R0584 1:R0584 Message transmission can be performed by using a PMC area starting at 1:R0600.'], '2.3 IMAGE OF DATA EXCHANGE': ['B-64164EN/01 SETTING 2.EXAMPLE OF CONNECTION - 105 - 2.3 IMAGE OF DATA EXCHANGE When data exchange is performed with the examples of configuration and parameter settings described ear lier, the illustration below shows how the data of each node is viewed in the PMC R area of each node. Node No. #1 Node No. #2 Node No. #3 1:R0000 1:R0000 1:R0000 1:R0100 Area 1 #11:R0100 Area 1 #1 1:R0100 Area 1 #1 1:R0108 Area 1 #21:R0108 Area 1 #2 1:R0108 Area 1 #2 1:R0116 Area 1 #31:R0116 Area 1 #3 1:R0116 Area 1 #3 1:R0124 1:R0124 1:R0124 1:R0200 Area 2 #11:R0200 Area 2 #1 1:R0200 Area 2 #1 1:R0328 Area 2 #21:R0328 Area 2 #2 1:R0328 Area 2 #2 1:R0456 Area 2 #31:R0456 Area 2 #3 1:R0456 Area 2 #3 1:R0584 1:R0584 1:R0584 Message transmission can be performed by using a PMC area starting at 1:R0600.', '', 'IV. CONNECTION', '', 'B-64164EN/01 CONNECTION 1.INSTALLATION - 109 - 1 INSTALLATION This chapter provides information required for installation of the FL-net board.'], 'IV. CONNECTION': ['B-64164EN/01 CONNECTION 1.INSTALLATION - 109 - 1 INSTALLATION This chapter provides information required for installation of the FL-net board.', '1.INSTALLATION CONNECTION B-64164EN/01 - 110 - 1.1 SPECIFICATIONS This section describes hardware specifications of the FL-net board. Name Ordering code A02B-0303-J272 Board drawing number A20B-8101-0031 Applicable model FANUC Series 30 i/300 i/300 is-MODEL A FANUC Series 31 i/310 i/310 is-MODEL A5 FANUC Series 31 i/310 i/310 is-MODEL A FANUC Series 32 i/320 i/320 is-MODEL A NOTE When using the board, observe the installation condition (environment condition within the cabinet) of the CNC control unit where the board is mounted. The power supply rating and heat dissipation of the FL-net board are listed below. For the CNC and other optional units , refer to the connection manual of the CNC. Name Power supply rating Heat dissipation FL-net board 0.2A 5W'], '1 INSTALLATION': ['B-64164EN/01 CONNECTION 1.INSTALLATION - 109 - 1 INSTALLATION This chapter provides information required for installation of the FL-net board.', '1.INSTALLATION CONNECTION B-64164EN/01 - 110 - 1.1 SPECIFICATIONS This section describes hardware specifications of the FL-net board. Name Ordering code A02B-0303-J272 Board drawing number A20B-8101-0031 Applicable model FANUC Series 30 i/300 i/300 is-MODEL A FANUC Series 31 i/310 i/310 is-MODEL A5 FANUC Series 31 i/310 i/310 is-MODEL A FANUC Series 32 i/320 i/320 is-MODEL A NOTE When using the board, observe the installation condition (environment condition within the cabinet) of the CNC control unit where the board is mounted. The power supply rating and heat dissipation of the FL-net board are listed below. For the CNC and other optional units , refer to the connection manual of the CNC. Name Power supply rating Heat dissipation FL-net board 0.2A 5W'], '1.1 SPECIFICATIONS': ['1.INSTALLATION CONNECTION B-64164EN/01 - 110 - 1.1 SPECIFICATIONS This section describes hardware specifications of the FL-net board. Name Ordering code A02B-0303-J272 Board drawing number A20B-8101-0031 Applicable model FANUC Series 30 i/300 i/300 is-MODEL A FANUC Series 31 i/310 i/310 is-MODEL A5 FANUC Series 31 i/310 i/310 is-MODEL A FANUC Series 32 i/320 i/320 is-MODEL A NOTE When using the board, observe the installation condition (environment condition within the cabinet) of the CNC control unit where the board is mounted. The power supply rating and heat dissipation of the FL-net board are listed below. For the CNC and other optional units , refer to the connection manual of the CNC. Name Power supply rating Heat dissipation FL-net board 0.2A 5W', 'B-64164EN/01 CONNECTION 1.INSTALLATION - 111 - 1.2 INSTALLATION This section describes information about the installation of the FL-net board. 1.2.1 Mounting into the LCD-mounted Type Unit The board is mounted into an option slot of the control unit. It occupies one slot. The option slot does not have mounting limitations. FL-net board 1.2.2 Mounting into the Stand-alone Type Unit The board is mounted into an option slot of the control unit. It occupies one slot. The option slot does not have mounting limitations.'], '1.2 INSTALLATION': ['B-64164EN/01 CONNECTION 1.INSTALLATION - 111 - 1.2 INSTALLATION This section describes information about the installation of the FL-net board. 1.2.1 Mounting into the LCD-mounted Type Unit The board is mounted into an option slot of the control unit. It occupies one slot. The option slot does not have mounting limitations. FL-net board 1.2.2 Mounting into the Stand-alone Type Unit The board is mounted into an option slot of the control unit. It occupies one slot. The option slot does not have mounting limitations.', '1.INSTALLATION CONNECTION B-64164EN/01 - 112 - 1.2.3 Total Connection Diagram CD38N 1T X + 2T X - 3R X + 4 5 6R X - 7 8 FL-net board HUB', 'B-64164EN/01 CONNECTION 2.CABLE CONNECTION - 113 - 2 CABLE CONNECTION This chapter describes information re lating to the Ethernet connection. CAUTION 1 Devices that transmit communication data of an Ethernet other than the FL-net must not be connected to the FL-net network. If such a device is connected, FL-net communication may not be performed properly. 2 Before connecting a cable to or detaching it from the FL-net board, turn off the power to the CNC, and confirm that the power is off. 3 Please inquire of each manufacturer about the construction of network or the condition of using the equipment except t he FL-net board (hub, transceiver, cable etc.). When configuring your network, you must take other sources of electrical noise into consideration to prevent your network from being influenced by electrical noise. Make sure that network wiring is sufficiently separated from power lines and other sources of electrical noise such as motors, and ground each of the devices as necessary. Also, a high and insufficient ground impedance may cause interference during communications. After installing the machine, conduct a communications test before you actually start operating the machine. We cannot ensure operation that is influenced by network trouble caused by a device other than the FL-net board.', '2.CABLE CONNECTION CONNECTION B-64164EN/01 - 114 - 2.1 CONNECTING TO ETHERNET The FL-net board is provided with a 10BASE-T interface. Prepare a hub for connecting the FL-net board to the Ethernet trunk. The following shows an example of a general connection. Some devices (hub, transceiver, etc. ) that are needed for building a network do not come in a dust-proof construction. Using such devices in an atmosphere where they are subjected to dust or oil mist will interfere with communications or da mage the FL-net board. Be sure to install such devices in a dust-proof cabinet. HUB CNC FL-net board・ ・ ・ Max. 100mTwisted pair cable', 'B-64164EN/01 CONNECTION 2.CABLE CONNECTION - 115 - 2.2 LEADING OUT THE ETHERNET CABLE 1) LCD-mounted type For this type of control unit, the cable is led out from the bottom of the control unit. See the outline drawing of the board for the location of the connector. Control unit Twisted-pair cable Ground plate ClampThe radius of the cable must be 70 mm or more. 2) Stand-alone type For this type of control unit, the cable is drawn out only from the front of the control unit. See the outline drawing of each type of board for the location of the connector. The radius of the cable must be 70 mm or more. Twisted-pair cable Clamp Ground plate The Ethernet cable must be fast ened by a cable clamp to prevent tension being applied to the modular connector (RJ-45) that connects the cable to the control un it even if the Ethernet cable is pulled directly. This clamp is also used to ground the cable shield.', '2.CABLE CONNECTION CONNECTION B-64164EN/01 - 116 - 2.3 10BASE-T CONNECTOR (CD38N) PIN ASSIGNMENTS CD38N Pin No. Signal name Description 1 TX+ Send + 2 TX- Send - 3 RX+ Receive + 4 Not used 5 Not used 6 RX- Receive - 7 Not used 8 Not used', 'B-64164EN/01 CONNECTION 2.CABLE CONNECTION - 117 - 2.4 TWISTED-PAIR CABLE SPECIFICATION 2.4.1 Cable Connection The cable used for connection between the 10BASE-T interface, CD38N, of the FL-net board and the hub is connected as follows: • Keep the total cable length within 100 m. Do not extend the cable more than is necessary. • The figure above shows the cable connection when cables are crossed in the hub. "X" is usually indicated at the port of the hub to signify that cables are crossed in the hub. X1 TX+ 2 TX- 3 RX+ 4 5 6 RX- 7 8 FL-net board CD38N 1 TX+ 2 TX- 3 RX+ 4 5 6 RX- 7 8 HUB RJ-45 modular connector MAX.100m TX+ (1) TX- (2) RX+ (3) RX- (6) (1) TX+ (2) TX-(3) RX+(6) RX- Shield 1 TX+ 2 TX-3 RX+R RX-TX+ 1 TX- 2 RX+ 3 RX- R x FL-net boardHUB Cables are crossed.', '2.CABLE CONNECTION CONNECTION B-64164EN/01 - 118 - 2.4.2 Cable Materials CAUTION Unshielded cable (UTP cable) is commercially available as 10BASE-T twisted-pair cable: You should, however, use shielded Category 5 twisted-pair cable (STP cable) to improve the resistance to electrical noise in an FA environment. Recommended Cables Manufacturer Specification Remarks Furukawa Electric Co., Ltd. DTS5087C-4P Twisted-pair cable Nissei Electric Co., Ltd. F-4PFWMF Single-conductor cable Inquiries Manufacturer Contact address Furukawa Electric Co., Ltd. Sales Headquarters 2-6-1 Marunouchi, Chiyoda-ku. Tokyo 100-8322TEL: 03-3286-3126 FAX: 03-3286-3979 Remarks Nissei Electric Co., Ltd. Machida Branch 3F MU Bldg., 1-9-1 Minami-narise, Machida City, Tokyo 194-0045 TEL: 0427-29-2531 FAX: 0427-29-3375 Overseas Sales Office IWATAN I International Corporation Tokyo Head Office 21-8 Nishi-shinbashi 3-chome, Minato-ku, TOKYO, 105-8458, JAPAN TEL: 03-5405-5810 FAX: 03-5405-5666 Telex: 2524256 IWATYO J Remarks A finished cable with connectors at both ends can be offered. NOTE The recommended cables cannot be connected to moving parts.', 'B-64164EN/01 CONNECTION 2.CABLE CONNECTION - 119 - Recommended cable (for movable parts) Manufacturer Specification Remarks Oki Electric Cable Co., Ltd. AWG26 4P TPMC-C5-F(SB) Shinko Electric Industrial Co., Ltd. FNC-118 Dedicated to FANUC Specification • Electric characteristics: Conforms to EIA/TIA 568A Category 3 and Category 5. From the viewpoint of attenuation performance, ensure that the length to the hub is 50 m or less. • Structure: Group shielded (braided shield). A drain wire is available. The conductor is an AWG26 ann ealed copper twisted wire, with a sheath thickness of 0.8 mm and an outer diameter of 6.7 mm ±0.3 mm. • Fire retardancy: UL1581 VW-1 • Oil resistance Conforms to the FANUC internal standards (equivalent to the conventional oil-resistant electric cables). • Flexing resistance: 1,000,000 times or more with a bending radius of 50 mm (U-shaped flex test) • UL style No.: AWM 20276 (80 °C/30V/VW-1) NOTE Be sure to use the connector TM21CP-88P(03) manufactured by Hirose Electric Co., Ltd. for this cable. Inquiries Manufacturer Contact address Oki Electric Cable Co., Ltd. Nagano Sales Office TEL: 0266-27-159 Remarks Shinko Electric Industrial Co., Ltd. Tokyo Sales Office TEL: 03-3492-0073 Remarks Cable assembly Oki Electric Cable Co., Ltd. can also supply the cable assembly mentioned above. Contact Oki Electric directly to determine the specifications (length, factory test, packing, and so forth) for purchase.', '2.CABLE CONNECTION CONNECTION B-64164EN/01 - 120 - 2.4.3 Connector Specification Use an 8-pin modular connector (RJ-45) with the twisted-pair cable for the Ethernet connection. The following connectors or equivalents must be used. For general use Specification Manufacturer Remarks Solid wire 5-569530-3 AMP Japan, Ltd. Solid wire MS8-RSZT-EMC SK KOHKI Co., Ltd. Special tools required Twisted-pair cable 5-569552-3 AMP Japan, Ltd. Twisted-pair cable TM11AP-88P Hirose Electric Co., Ltd. Special tools required For movable parts Specification Manufacturer Remarks For cable AWG26 4P TPMC-C5-F(SB) or FNC-118 TM21CP-88P(03) Hirose Electric Co., Ltd. Note NOTE Information about TM21CP-88P(03): Connector (standard product of the manufacturer) Drawing number: A63L-0001-0823#P Manufacturer: Hirose Electric Co., Ltd. Manufacturer type number: TM21CP-88P(03) Conforms to EIA/TIA 568A Category 3 and Category 5. For assembly with a cable, contact Hirose Electric Co., Ltd. directly. (From Hirose Electric Co., Ltd., "TM21CP-88P(03) Connection Procedure Manual (Technical Specification No. ATAD-E2367)" is available as a technical document.)', 'B-64164EN/01 CONNECTION 2.CABLE CONNECTION - 121 - 2.4.4 HUB Recommended hub Manufacturer Specification Remarks Contec Co., Ltd. RT-1008H 10BASE-T Eight ports Phoenix Contact FL HUB 10BASE-T 10BASE-T Four ports NOTE Before using the hub, refer to the operation manual supplied by the manufacturer. Contact points Manufacturer Contact address Contec Co., Ltd. East Branch Tachibana Annex Building, 2-25-14 Kameido, Koto Ward, Tokyo, 136-0071 TEL: 03-5628-0211 (pilot number) FAX: 03-5628-0210 Remarks http://www.contec.co.jp Phoenix Contact Headquarters Yuusen Sin-yokohama 1-Chome Building, Sin-yokohama, Kohoku Ward, Yokohama, 222-0033 TEL: 045-471-0030 FAX: 045-471-0031 Remarks http://www. phoenixcontact.co.jp', '2.CABLE CONNECTION CONNECTION B-64164EN/01 - 122 - 2.5 ELECTRICAL NOISE COUNTERMEASURES 2.5.1 Separating Signal Lines For signal line separation, refer to the description of noise protection in the Connection Manual (Hardware) of CNC. The wiring for the Ethernet cable is of group C. 2.5.2 Clamping and Shielding Cables Clamp an Ethernet twisted pair cable according to the method described below, as with cables that need to be shielded. Clamping cables provides support and shielding and is extremely important to the safe operation of the system. Never overlook cable clamping. Peel off part of the jacket as shown in the figure to expose the outer coating of the shield, and press this outer coating against the ground plate with the clamp fixture. The machine manufacturer must prepare the ground plate and install it as follows: Shield Peel off jacketGround plate Ground plate Cable Cable clamp NOTE To ensure the safe operation of the system, clamp and shield the cables.', 'B-64164EN/01 CONNECTION 2.CABLE CONNECTION - 123 - The FL–net boards in an optional slots of CNC machines are connected to the hub through twisted pair cables. The cables are shielded with clamping hardware. Be sure to perform shielding since it is very important for stabilization of the system operation. Shielding must be performed for both ends of the cable as close as possible to the connectors on the CNC and hub sides. When the cables are short and the connectors on the CNC and hub sides are accommodated in the power magnetics cabinet, however, shielding is performed only on the hub side. Twisted pair cable Shield HUB Power magnetics cabinet Control unitPower magnetics cabinet Control unit Example of shielding of transceiver cable (When LCD-mounted type Series 30 i-A) Prepare the following earth plate. Mounting screw hole Ground terminal (used for grounding) Clamp fixturemounting hole Use a nickel-plated iron plate at least 2 mm thick as the ground plate.', '2.CABLE CONNECTION CONNECTION B-64164EN/01 - 124 - Ground plate 8mm 12mm 20mm Details of clamp fixture mounting holes 55mm max. 28mm 6mm 17mm External dimensions of clamp fixture NOTE 1 Unlike ordinary Ethernet communication, FL-net communication does not perform retransmission processing that is performed at intervals of several seconds. This is to achieve high-speed response. Therefore, FL-net cable installation must be more resistant to noise than ordinary Ethernet cable installation. 2 After cable installation, conduct sufficient communication tests not only before system operation but also after system operation to ensure noise resistance.', 'B-64164EN/01 CONNECTION 2.CABLE CONNECTION - 125 - 2.5.3 Grounding the Network Even if the grounding condition on the machine side is satisfied, the communication line can pick up noise from the machine, depending on the machine installation condition and environment, thus resulting in a communication error. To protect against such noise, the machine should be separated and insulated from the Ethernet trunk cable and personal computer. Examples of connection are given below. FL-net MachineMachine MachineSTP cable STP cableElectrically separated by 10BASE-T cable connection Personal computer Personal computer/ HUB side Machine system Note 1Hub power supply Note 1 Note 1Note 1 HUB Note 2 Note 1 Note 1 Note 1 HUB Note 2 Note 2 Switching HUB Large-Scale Network Note 1 HUB STP cable Electrically separated by 10BASE-T cable connection Personal computer Note 1 Personal computer/Ethernet trunk side Machine systemHub power supply FL-net Machine Note 2 Note 1 Note 1 Small-Scale Network', '2.CABLE CONNECTION CONNECTION B-64164EN/01 - 126 - NOTE 1 The ground between PC/HUB side and machine system side must be separated. If it is impossible to separate the ground because there is only one grounding point, connect the ground cable for each system to the grounding point independently. (See figure below.) The resistance for grounding must be less than 100-ohm (Class D). The thickness of the ground cable is the same as the thickness of AC power cable or more. At least thickness of 5.5mm 2 is necessary. 2 Note that the number of allowable hub-to-hub connections depends on the type of hub. 3 There is possibility that noise makes the obstacle of communication even if the ground is separated using the 10BASE-T. In the case of using the FL-net board under the worst environment, please separate between the PC/Trunk line side and machine system side completely using the 10BASE-FL (Optical fiber media). HUB FG Ground wire on personal computer and trunk sides Ground wire on machine systemFG Ground pointNote 2 Ground wire on machine system Wiring on a single ground point', 'V. MAINTENANCE', '', 'B-64164EN/01 MAINTENANCE 1.HARDWARE MAINTENANCE INFORMATION - 129 - 1 HARDWARE MAINTENANCE INFORMATION This chapter provides hardware ma intenance information related to the FL-net functions.'], 'V. MAINTENANCE': ['B-64164EN/01 MAINTENANCE 1.HARDWARE MAINTENANCE INFORMATION - 129 - 1 HARDWARE MAINTENANCE INFORMATION This chapter provides hardware ma intenance information related to the FL-net functions.', '1.HARDWARE MAINTENANCE INFORMATION MAINTENANCE B-64164EN/01 - 130 - 1.1 BOARD This section describes the maintena nce information for the FL-net board. 1.1.1 Component Layout MPU LSI CD38N Name PCB drawing No. Remarks FL-net board A20B-8101-0031'], '1 HARDWARE MAINTENANCE INFORMATION': ['B-64164EN/01 MAINTENANCE 1.HARDWARE MAINTENANCE INFORMATION - 129 - 1 HARDWARE MAINTENANCE INFORMATION This chapter provides hardware ma intenance information related to the FL-net functions.', '1.HARDWARE MAINTENANCE INFORMATION MAINTENANCE B-64164EN/01 - 130 - 1.1 BOARD This section describes the maintena nce information for the FL-net board. 1.1.1 Component Layout MPU LSI CD38N Name PCB drawing No. Remarks FL-net board A20B-8101-0031'], '1.1 BOARD': ['1.HARDWARE MAINTENANCE INFORMATION MAINTENANCE B-64164EN/01 - 130 - 1.1 BOARD This section describes the maintena nce information for the FL-net board. 1.1.1 Component Layout MPU LSI CD38N Name PCB drawing No. Remarks FL-net board A20B-8101-0031', "B-64164EN/01 MAINTENANCE 1.HARDWARE MAINTENANCE INFORMATION - 131 - 1.1.2 LED Indications and Meanings The FL-net board has four green LEDs (1 to 4) and one red LED (ALM) for state indication, and two green LEDs (BTX and LIL), one red LED (COL), and one yellow LED (COM) for communication status indication. The locations and meanings of the LEDs are described below. In the descrip tion below, the following marks are used to represent the display states of each LED: \x86: Off \x84: On \x9c: Blinking ◊: Don't care CD38N 4(POK) (GREEN) 3(LNK) (GREEN) 2(RES) (GREEN) 1(ROS) (GREEN) ALR (HER) (RED)LIL (GREEN) COL (RED) COM (GREEN) BTX (GREEN) NOTE The face plate is indicated using dotted lines."], '1.1.1 Component Layout': ['1.HARDWARE MAINTENANCE INFORMATION MAINTENANCE B-64164EN/01 - 130 - 1.1 BOARD This section describes the maintena nce information for the FL-net board. 1.1.1 Component Layout MPU LSI CD38N Name PCB drawing No. Remarks FL-net board A20B-8101-0031', "B-64164EN/01 MAINTENANCE 1.HARDWARE MAINTENANCE INFORMATION - 131 - 1.1.2 LED Indications and Meanings The FL-net board has four green LEDs (1 to 4) and one red LED (ALM) for state indication, and two green LEDs (BTX and LIL), one red LED (COL), and one yellow LED (COM) for communication status indication. The locations and meanings of the LEDs are described below. In the descrip tion below, the following marks are used to represent the display states of each LED: \x86: Off \x84: On \x9c: Blinking ◊: Don't care CD38N 4(POK) (GREEN) 3(LNK) (GREEN) 2(RES) (GREEN) 1(ROS) (GREEN) ALR (HER) (RED)LIL (GREEN) COL (RED) COM (GREEN) BTX (GREEN) NOTE The face plate is indicated using dotted lines."], '1.1.2 LED Indications and Meanings': ["B-64164EN/01 MAINTENANCE 1.HARDWARE MAINTENANCE INFORMATION - 131 - 1.1.2 LED Indications and Meanings The FL-net board has four green LEDs (1 to 4) and one red LED (ALM) for state indication, and two green LEDs (BTX and LIL), one red LED (COL), and one yellow LED (COM) for communication status indication. The locations and meanings of the LEDs are described below. In the descrip tion below, the following marks are used to represent the display states of each LED: \x86: Off \x84: On \x9c: Blinking ◊: Don't care CD38N 4(POK) (GREEN) 3(LNK) (GREEN) 2(RES) (GREEN) 1(ROS) (GREEN) ALR (HER) (RED)LIL (GREEN) COL (RED) COM (GREEN) BTX (GREEN) NOTE The face plate is indicated using dotted lines.", '1.HARDWARE MAINTENANCE INFORMATION MAINTENANCE B-64164EN/01 - 132 - LED display transition for LED1, LED2 , LED3, and LED4 (during power-on) LED indication 4 3 2 1 Status Meaning \x86\x86\x86\x86 Power-off \x84\x84\x84\x84 Immediately after power-on Initial state entered imm ediately after power-on. If the board is stopped in this condition, the cause is one of the following: → The firmware is not stored in the Flash ROM of the CNC. → The board is defective. \x84\x84\x84\x86 Start of board The board has started. If the board is stopped in this condition, the board may be defective. \x84\x84\x86\x86 Completion of firmware downloading The firmware has been downloaded to the board. If the board is stopped in this condition, the board may be defective. \x84\x86\x86\x86 Firmware OS started. The firmware OS has started. If the board is stopped in this condition, the cause is one of the following: → The firmware stored in the flash ROM of the CNC is destroyed. → The board is defective. \x86\x84\x84\x84 Completion of firmware OS initialization Initialization of the firmw are OS is completed. If the board is stopped in this condition, the cause is one of the following: → The firmware in the flash ROM of the CNC is destroyed. → The board is defective. ◊◊\x86\x9c Start completion The board has started normally. LED display transition for LED1, LED2, LED3, and LED4 (during normal operation) LED indication Status Meaning ROS \x9c Normal software operation Blinks at 1-second intervals when the communication software on the FL-net board operates normally. RES \x86 Normally OFF Normally, off LNK \x84 Participating in network Turned on when the node participates in the FL-net network POK \x84 Normal parameters Turned on when a ll FL-net parameters are valid. BTX, LIL, COM, and ALM LED indi cations (during normal operation) LED indication Status Meaning BTX \x86 10BASE-T connection in progress The communication rate is 10BASE-T. LIL \x84 Connected to hub The board is connected to the hub. COM \x84 Transmission/ reception in progress Data is being transmitted or received. ALM \x86 (HER) No alarm No alarm is issued', 'B-64164EN/01 MAINTENANCE 1.HARDWARE MAINTENANCE INFORMATION - 133 - LED1, LED2, LED3, and LED4 indications (when abnormality occurs) The STATUS LEDs are turned on and off repeatedly with long on-time and short on-time. LED indication [Long on-time] 4 3 2 1 LED indication [Short on-time] 4 3 2 1 Status Description \x84\x84\x86\x86 \x86\x86\x86\x84 Error on another board A defect on another board or a problem on another board was detected. \x84\x84\x86\x86 \x86\x86\x84\x86 Bus error Software has a problem, or the board is defective. \x84\x84\x86\x86 \x86\x86\x84\x84 Parity alarm The board is defective. \x84\x86\x84\x86 \x86\x86\x86\x86 Illegal general instruction Software has a problem, or the board is defective. \x84\x86\x84\x86 \x86\x86\x86\x84 Illegal slot instruction Software has a problem, or the board is defective. \x84\x86\x84\x86 \x86\x84\x86\x86 CPU address error Software has a problem, or the board is defective. NOTE If an error occurs with the LEDs turned on and off with long on-time and short on-time in a manner not indicated above, contact FANUC. COL, LIL, and ALM LED indications (when abnormality occurs) LED indication Status Description COL ■ COL ☆ Collision occurs. (Data collision occurs.) When a data collision occurs on the network, the LED is lit or blinks. (Note) LIL □ Not connected to hub The board is not connected to the hub properly. The LIL LEF stays off also when the power to the hub is off. Check whether the board is connected to the hub properly. ALM ■ (HER) Parity error occurs. A parity e rror occurred in memory on the board. The board is defective. NOTE The FL-net manages the token-based transmission right so that no collision occurs. If this LED is turned on frequently, a communication error has occurred due to noise, or an Ethernet compliant product other than the FL-net is connected. In such a case, check the devices connected to the network and the network installation status.', '2.SOFTWARE MAINTENANCE INFORMATION MAINTENANCE B-64164EN/01 - 134 - 2 SOFTWARE MAINTENANCE INFORMATION This chapter provides software main tenance information related to the FL-net functions.'], '2 SOFTWARE MAINTENANCE INFORMATION': ['2.SOFTWARE MAINTENANCE INFORMATION MAINTENANCE B-64164EN/01 - 134 - 2 SOFTWARE MAINTENANCE INFORMATION This chapter provides software main tenance information related to the FL-net functions.', 'B-64164EN/01 MAINTENANCE 2.SOFTWARE MAINTENANCE INFORMATION - 135 - 2.1 FL-net COMMUNICATION HISTORY Communication history of the FL-net function is displayed. FL-net COMMUNICATION HISTORY screen Procedure 1 Press function key MESSAGE . 2 Press the [FL-net MSG] soft key. The FL-net COMMUNICATION HISTORY screen for the FL-net function then appears. (When the soft key is not displayed, press the next-menu key.) Screen 2-1 FL-net COMMUNICATION HISTORY Screen The most recent message in the communication history information is displayed on the top of the screen. Displayed at the right end is the time and date of the issuance of the message. The month (MMM), day (DD), hour (hh), minute (mm), and second (ss) are indicated in the format "MMM.DD hh:mm:ss". In the uppermost example on the above screen, "21:42:06 on May 28" is indicated. To clear the FL-net communication history, press the [(OPRT)] soft key, then press the [CLEAR] soft key.'], '2.1 FL-net COMMUNICATION HISTORY': ['B-64164EN/01 MAINTENANCE 2.SOFTWARE MAINTENANCE INFORMATION - 135 - 2.1 FL-net COMMUNICATION HISTORY Communication history of the FL-net function is displayed. FL-net COMMUNICATION HISTORY screen Procedure 1 Press function key MESSAGE . 2 Press the [FL-net MSG] soft key. The FL-net COMMUNICATION HISTORY screen for the FL-net function then appears. (When the soft key is not displayed, press the next-menu key.) Screen 2-1 FL-net COMMUNICATION HISTORY Screen The most recent message in the communication history information is displayed on the top of the screen. Displayed at the right end is the time and date of the issuance of the message. The month (MMM), day (DD), hour (hh), minute (mm), and second (ss) are indicated in the format "MMM.DD hh:mm:ss". In the uppermost example on the above screen, "21:42:06 on May 28" is indicated. To clear the FL-net communication history, press the [(OPRT)] soft key, then press the [CLEAR] soft key.', '2.SOFTWARE MAINTENANCE INFORMATION MAINTENANCE B-64164EN/01 - 136 - The displayed contents can be changed by using soft keys on the FL-net COMMUNICATION HISTORY screen. (1) [ALL] soft key Displays all communication history information related to FL-net communication. (2) [ERROR] soft key Displays only error-related communication history information in the FL-net communication history. The following lists major communication history information: Error message Meaning and action to be taken E-0113 Token Holding time is up Token hold time of the local node is insufficient. Set a larger value in the token monitoring time parameter. E-0115 Sum-check of IP layer is invalid Received data is destroyed. Data may have been destroyed by noise or by connection of a non-FL-net device. Check the connected devices and the network cable installation status. E-0118 FL-net startup The local device has start ed normally at power-on. This is not an error. E-0119 Self-node is in-ring The local device has participated in the network. This is not an error. E-011A Wait for any frame When only the local devic e is connected to the network, the device is wait ing for data from another device. This is not an error. E-011D Token is reissued When a token is not transmitted from the node preceding the local node, a token is reissued. E-012B Send Error(Retry over) E-012C Send Error(Collision) E-012D Send Error(Carrier Lost) E-012E Send Error(No Carrier) E-012F Send Error(Bad frame) A transmission error occurred. Data may have been destroyed by noise or by connection of a non-FL-net device. Check the connected devices and the network cable installation status. E-0130 Receive Error(Bad CRC) E-0131 Receive Error(PHY-LSI) E-0132 Receive Error(Short frame) E-0133 Receive Error(Long frame) E-0134 Receive Error(Nonoctet Aligned frame) E-0135 Receive Error(Overflow) A reception error occurred. Data may have been destroyed by noise or by connection of a non-FL-net device. Check the connected devices and the network cable installation status. E-0201 Node number is duplicated [999] The node number of the local device is the same as the node number of another dev ice. Correct the IP address setting not to duplicate the node number. The duplicated node number is [999]. E-0202 Protocol version is different [999] A device with a different protocol version (node number [999]) was detect ed on the network. All devices must comply with the FL-net communication standards version 2.00.']}

